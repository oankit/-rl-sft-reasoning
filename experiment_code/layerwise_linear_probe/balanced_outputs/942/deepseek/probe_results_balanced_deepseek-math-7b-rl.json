{
  "model_name": "deepseek-ai/deepseek-math-7b-rl",
  "n_layers": 30,
  "n_train": 700,
  "n_val": 150,
  "n_test": 150,
  "n_total": 1000,
  "n_correct": 98,
  "n_incorrect": 902,
  "correct_ratio": 9.8,
  "class_weight": "balanced",
  "indices_path": "/Users/antyabharahman/Downloads/Personal/final_research/paper_codebase/-rl-sft-reasoning/experiment_code/layerwise_linear_probe/balanced_outputs/942/deepseek/balanced_indices_deepseek-math-7b-rl.json",
  "probe_config": {
    "cv_folds": 5,
    "C_range": [
      0.01,
      0.1,
      1.0,
      10.0,
      100.0
    ],
    "max_iter": 5000,
    "random_state": 42,
    "solver": "lbfgs"
  },
  "layer_results": [
    {
      "layer": 0,
      "best_C": 100.0,
      "train": {
        "accuracy": 0.9357142857142857,
        "precision": 0.6017699115044248,
        "recall": 1.0,
        "f1": 0.7513812154696132
      },
      "val": {
        "accuracy": 0.8533333333333334,
        "precision": 0.2916666666666667,
        "recall": 0.5833333333333334,
        "f1": 0.3888888888888889
      },
      "test": {
        "accuracy": 0.8266666666666667,
        "precision": 0.34615384615384615,
        "recall": 0.5,
        "f1": 0.4090909090909091
      }
    },
    {
      "layer": 1,
      "best_C": 100.0,
      "train": {
        "accuracy": 0.9842857142857143,
        "precision": 0.8607594936708861,
        "recall": 1.0,
        "f1": 0.9251700680272109
      },
      "val": {
        "accuracy": 0.8866666666666667,
        "precision": 0.35294117647058826,
        "recall": 0.5,
        "f1": 0.41379310344827586
      },
      "test": {
        "accuracy": 0.8266666666666667,
        "precision": 0.3181818181818182,
        "recall": 0.3888888888888889,
        "f1": 0.35
      }
    },
    {
      "layer": 2,
      "best_C": 100.0,
      "train": {
        "accuracy": 0.9985714285714286,
        "precision": 0.9855072463768116,
        "recall": 1.0,
        "f1": 0.9927007299270073
      },
      "val": {
        "accuracy": 0.8866666666666667,
        "precision": 0.3333333333333333,
        "recall": 0.4166666666666667,
        "f1": 0.37037037037037035
      },
      "test": {
        "accuracy": 0.8533333333333334,
        "precision": 0.4,
        "recall": 0.4444444444444444,
        "f1": 0.42105263157894735
      }
    },
    {
      "layer": 3,
      "best_C": 100.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.86,
        "precision": 0.23529411764705882,
        "recall": 0.3333333333333333,
        "f1": 0.27586206896551724
      },
      "test": {
        "accuracy": 0.8466666666666667,
        "precision": 0.3684210526315789,
        "recall": 0.3888888888888889,
        "f1": 0.3783783783783784
      }
    },
    {
      "layer": 4,
      "best_C": 100.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.8733333333333333,
        "precision": 0.23076923076923078,
        "recall": 0.25,
        "f1": 0.24
      },
      "test": {
        "accuracy": 0.8333333333333334,
        "precision": 0.29411764705882354,
        "recall": 0.2777777777777778,
        "f1": 0.2857142857142857
      }
    },
    {
      "layer": 5,
      "best_C": 100.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.88,
        "precision": 0.2857142857142857,
        "recall": 0.3333333333333333,
        "f1": 0.3076923076923077
      },
      "test": {
        "accuracy": 0.84,
        "precision": 0.2857142857142857,
        "recall": 0.2222222222222222,
        "f1": 0.25
      }
    },
    {
      "layer": 6,
      "best_C": 100.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.8733333333333333,
        "precision": 0.26666666666666666,
        "recall": 0.3333333333333333,
        "f1": 0.2962962962962963
      },
      "test": {
        "accuracy": 0.8466666666666667,
        "precision": 0.35294117647058826,
        "recall": 0.3333333333333333,
        "f1": 0.34285714285714286
      }
    },
    {
      "layer": 7,
      "best_C": 100.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.8666666666666667,
        "precision": 0.25,
        "recall": 0.3333333333333333,
        "f1": 0.2857142857142857
      },
      "test": {
        "accuracy": 0.8466666666666667,
        "precision": 0.3333333333333333,
        "recall": 0.2777777777777778,
        "f1": 0.30303030303030304
      }
    },
    {
      "layer": 8,
      "best_C": 100.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.8733333333333333,
        "precision": 0.3157894736842105,
        "recall": 0.5,
        "f1": 0.3870967741935484
      },
      "test": {
        "accuracy": 0.8466666666666667,
        "precision": 0.3076923076923077,
        "recall": 0.2222222222222222,
        "f1": 0.25806451612903225
      }
    },
    {
      "layer": 9,
      "best_C": 1.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.8733333333333333,
        "precision": 0.29411764705882354,
        "recall": 0.4166666666666667,
        "f1": 0.3448275862068966
      },
      "test": {
        "accuracy": 0.8533333333333334,
        "precision": 0.3888888888888889,
        "recall": 0.3888888888888889,
        "f1": 0.3888888888888889
      }
    },
    {
      "layer": 10,
      "best_C": 100.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.8733333333333333,
        "precision": 0.29411764705882354,
        "recall": 0.4166666666666667,
        "f1": 0.3448275862068966
      },
      "test": {
        "accuracy": 0.8666666666666667,
        "precision": 0.4444444444444444,
        "recall": 0.4444444444444444,
        "f1": 0.4444444444444444
      }
    },
    {
      "layer": 11,
      "best_C": 1.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.86,
        "precision": 0.23529411764705882,
        "recall": 0.3333333333333333,
        "f1": 0.27586206896551724
      },
      "test": {
        "accuracy": 0.8533333333333334,
        "precision": 0.4090909090909091,
        "recall": 0.5,
        "f1": 0.45
      }
    },
    {
      "layer": 12,
      "best_C": 10.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.86,
        "precision": 0.2,
        "recall": 0.25,
        "f1": 0.2222222222222222
      },
      "test": {
        "accuracy": 0.8666666666666667,
        "precision": 0.4444444444444444,
        "recall": 0.4444444444444444,
        "f1": 0.4444444444444444
      }
    },
    {
      "layer": 13,
      "best_C": 100.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.8733333333333333,
        "precision": 0.26666666666666666,
        "recall": 0.3333333333333333,
        "f1": 0.2962962962962963
      },
      "test": {
        "accuracy": 0.8466666666666667,
        "precision": 0.3684210526315789,
        "recall": 0.3888888888888889,
        "f1": 0.3783783783783784
      }
    },
    {
      "layer": 14,
      "best_C": 1.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.8666666666666667,
        "precision": 0.25,
        "recall": 0.3333333333333333,
        "f1": 0.2857142857142857
      },
      "test": {
        "accuracy": 0.8533333333333334,
        "precision": 0.375,
        "recall": 0.3333333333333333,
        "f1": 0.35294117647058826
      }
    },
    {
      "layer": 15,
      "best_C": 100.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.86,
        "precision": 0.2631578947368421,
        "recall": 0.4166666666666667,
        "f1": 0.3225806451612903
      },
      "test": {
        "accuracy": 0.8533333333333334,
        "precision": 0.4,
        "recall": 0.4444444444444444,
        "f1": 0.42105263157894735
      }
    },
    {
      "layer": 16,
      "best_C": 10.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.88,
        "precision": 0.2857142857142857,
        "recall": 0.3333333333333333,
        "f1": 0.3076923076923077
      },
      "test": {
        "accuracy": 0.8466666666666667,
        "precision": 0.3333333333333333,
        "recall": 0.2777777777777778,
        "f1": 0.30303030303030304
      }
    },
    {
      "layer": 17,
      "best_C": 0.1,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.86,
        "precision": 0.2631578947368421,
        "recall": 0.4166666666666667,
        "f1": 0.3225806451612903
      },
      "test": {
        "accuracy": 0.8733333333333333,
        "precision": 0.4666666666666667,
        "recall": 0.3888888888888889,
        "f1": 0.42424242424242425
      }
    },
    {
      "layer": 18,
      "best_C": 1.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.8733333333333333,
        "precision": 0.23076923076923078,
        "recall": 0.25,
        "f1": 0.24
      },
      "test": {
        "accuracy": 0.8666666666666667,
        "precision": 0.4375,
        "recall": 0.3888888888888889,
        "f1": 0.4117647058823529
      }
    },
    {
      "layer": 19,
      "best_C": 10.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.8666666666666667,
        "precision": 0.16666666666666666,
        "recall": 0.16666666666666666,
        "f1": 0.16666666666666666
      },
      "test": {
        "accuracy": 0.8533333333333334,
        "precision": 0.35714285714285715,
        "recall": 0.2777777777777778,
        "f1": 0.3125
      }
    },
    {
      "layer": 20,
      "best_C": 0.1,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.8266666666666667,
        "precision": 0.0625,
        "recall": 0.08333333333333333,
        "f1": 0.07142857142857142
      },
      "test": {
        "accuracy": 0.84,
        "precision": 0.2857142857142857,
        "recall": 0.2222222222222222,
        "f1": 0.25
      }
    },
    {
      "layer": 21,
      "best_C": 10.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.82,
        "precision": 0.0,
        "recall": 0.0,
        "f1": 0.0
      },
      "test": {
        "accuracy": 0.82,
        "precision": 0.15384615384615385,
        "recall": 0.1111111111111111,
        "f1": 0.12903225806451613
      }
    },
    {
      "layer": 22,
      "best_C": 1.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.82,
        "precision": 0.0,
        "recall": 0.0,
        "f1": 0.0
      },
      "test": {
        "accuracy": 0.8333333333333334,
        "precision": 0.26666666666666666,
        "recall": 0.2222222222222222,
        "f1": 0.24242424242424243
      }
    },
    {
      "layer": 23,
      "best_C": 10.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.8466666666666667,
        "precision": 0.07692307692307693,
        "recall": 0.08333333333333333,
        "f1": 0.08
      },
      "test": {
        "accuracy": 0.84,
        "precision": 0.2857142857142857,
        "recall": 0.2222222222222222,
        "f1": 0.25
      }
    },
    {
      "layer": 24,
      "best_C": 10.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.84,
        "precision": 0.125,
        "recall": 0.16666666666666666,
        "f1": 0.14285714285714285
      },
      "test": {
        "accuracy": 0.82,
        "precision": 0.15384615384615385,
        "recall": 0.1111111111111111,
        "f1": 0.12903225806451613
      }
    },
    {
      "layer": 25,
      "best_C": 10.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.8733333333333333,
        "precision": 0.23076923076923078,
        "recall": 0.25,
        "f1": 0.24
      },
      "test": {
        "accuracy": 0.82,
        "precision": 0.09090909090909091,
        "recall": 0.05555555555555555,
        "f1": 0.06896551724137931
      }
    },
    {
      "layer": 26,
      "best_C": 0.1,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.8266666666666667,
        "precision": 0.1111111111111111,
        "recall": 0.16666666666666666,
        "f1": 0.13333333333333333
      },
      "test": {
        "accuracy": 0.8333333333333334,
        "precision": 0.26666666666666666,
        "recall": 0.2222222222222222,
        "f1": 0.24242424242424243
      }
    },
    {
      "layer": 27,
      "best_C": 100.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.88,
        "precision": 0.2857142857142857,
        "recall": 0.3333333333333333,
        "f1": 0.3076923076923077
      },
      "test": {
        "accuracy": 0.8466666666666667,
        "precision": 0.2727272727272727,
        "recall": 0.16666666666666666,
        "f1": 0.20689655172413793
      }
    },
    {
      "layer": 28,
      "best_C": 0.01,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.8666666666666667,
        "precision": 0.21428571428571427,
        "recall": 0.25,
        "f1": 0.23076923076923078
      },
      "test": {
        "accuracy": 0.84,
        "precision": 0.3125,
        "recall": 0.2777777777777778,
        "f1": 0.29411764705882354
      }
    },
    {
      "layer": 29,
      "best_C": 10.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.86,
        "precision": 0.2,
        "recall": 0.25,
        "f1": 0.2222222222222222
      },
      "test": {
        "accuracy": 0.84,
        "precision": 0.2857142857142857,
        "recall": 0.2222222222222222,
        "f1": 0.25
      }
    }
  ]
}