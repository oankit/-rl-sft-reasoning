{
  "model_name": "deepseek-ai/deepseek-math-7b-instruct",
  "n_layers": 30,
  "n_train": 700,
  "n_val": 150,
  "n_test": 150,
  "n_total": 1000,
  "n_correct": 152,
  "n_incorrect": 848,
  "correct_ratio": 15.2,
  "class_weight": "balanced",
  "indices_path": "/Users/antyabharahman/Downloads/Personal/final_research/paper_codebase/-rl-sft-reasoning/experiment_code/layerwise_linear_probe/balanced_outputs/942/deepseek/balanced_indices_deepseek-math-7b-instruct.json",
  "probe_config": {
    "cv_folds": 5,
    "C_range": [
      0.01,
      0.1,
      1.0,
      10.0,
      100.0
    ],
    "max_iter": 5000,
    "random_state": 42,
    "solver": "lbfgs"
  },
  "layer_results": [
    {
      "layer": 0,
      "best_C": 100.0,
      "train": {
        "accuracy": 0.8757142857142857,
        "precision": 0.5561797752808989,
        "recall": 0.9252336448598131,
        "f1": 0.6947368421052632
      },
      "val": {
        "accuracy": 0.8,
        "precision": 0.3902439024390244,
        "recall": 0.7619047619047619,
        "f1": 0.5161290322580645
      },
      "test": {
        "accuracy": 0.8066666666666666,
        "precision": 0.4358974358974359,
        "recall": 0.7083333333333334,
        "f1": 0.5396825396825397
      }
    },
    {
      "layer": 1,
      "best_C": 100.0,
      "train": {
        "accuracy": 0.9428571428571428,
        "precision": 0.7278911564625851,
        "recall": 1.0,
        "f1": 0.84251968503937
      },
      "val": {
        "accuracy": 0.86,
        "precision": 0.5,
        "recall": 0.7619047619047619,
        "f1": 0.6037735849056604
      },
      "test": {
        "accuracy": 0.8333333333333334,
        "precision": 0.48484848484848486,
        "recall": 0.6666666666666666,
        "f1": 0.5614035087719298
      }
    },
    {
      "layer": 2,
      "best_C": 100.0,
      "train": {
        "accuracy": 0.9685714285714285,
        "precision": 0.8294573643410853,
        "recall": 1.0,
        "f1": 0.9067796610169492
      },
      "val": {
        "accuracy": 0.8533333333333334,
        "precision": 0.48484848484848486,
        "recall": 0.7619047619047619,
        "f1": 0.5925925925925926
      },
      "test": {
        "accuracy": 0.8666666666666667,
        "precision": 0.5769230769230769,
        "recall": 0.625,
        "f1": 0.6
      }
    },
    {
      "layer": 3,
      "best_C": 100.0,
      "train": {
        "accuracy": 0.99,
        "precision": 0.9385964912280702,
        "recall": 1.0,
        "f1": 0.9683257918552036
      },
      "val": {
        "accuracy": 0.8666666666666667,
        "precision": 0.5185185185185185,
        "recall": 0.6666666666666666,
        "f1": 0.5833333333333334
      },
      "test": {
        "accuracy": 0.8666666666666667,
        "precision": 0.5666666666666667,
        "recall": 0.7083333333333334,
        "f1": 0.6296296296296297
      }
    },
    {
      "layer": 4,
      "best_C": 100.0,
      "train": {
        "accuracy": 0.9985714285714286,
        "precision": 0.9907407407407407,
        "recall": 1.0,
        "f1": 0.9953488372093023
      },
      "val": {
        "accuracy": 0.88,
        "precision": 0.56,
        "recall": 0.6666666666666666,
        "f1": 0.6086956521739131
      },
      "test": {
        "accuracy": 0.8666666666666667,
        "precision": 0.5833333333333334,
        "recall": 0.5833333333333334,
        "f1": 0.5833333333333334
      }
    },
    {
      "layer": 5,
      "best_C": 100.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.88,
        "precision": 0.5652173913043478,
        "recall": 0.6190476190476191,
        "f1": 0.5909090909090909
      },
      "test": {
        "accuracy": 0.8466666666666667,
        "precision": 0.5185185185185185,
        "recall": 0.5833333333333334,
        "f1": 0.5490196078431373
      }
    },
    {
      "layer": 6,
      "best_C": 100.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.8666666666666667,
        "precision": 0.52,
        "recall": 0.6190476190476191,
        "f1": 0.5652173913043478
      },
      "test": {
        "accuracy": 0.8666666666666667,
        "precision": 0.5714285714285714,
        "recall": 0.6666666666666666,
        "f1": 0.6153846153846154
      }
    },
    {
      "layer": 7,
      "best_C": 10.0,
      "train": {
        "accuracy": 0.9985714285714286,
        "precision": 0.9907407407407407,
        "recall": 1.0,
        "f1": 0.9953488372093023
      },
      "val": {
        "accuracy": 0.8533333333333334,
        "precision": 0.48,
        "recall": 0.5714285714285714,
        "f1": 0.5217391304347826
      },
      "test": {
        "accuracy": 0.8933333333333333,
        "precision": 0.7,
        "recall": 0.5833333333333334,
        "f1": 0.6363636363636364
      }
    },
    {
      "layer": 8,
      "best_C": 10.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.8733333333333333,
        "precision": 0.5454545454545454,
        "recall": 0.5714285714285714,
        "f1": 0.5581395348837209
      },
      "test": {
        "accuracy": 0.8866666666666667,
        "precision": 0.6666666666666666,
        "recall": 0.5833333333333334,
        "f1": 0.6222222222222222
      }
    },
    {
      "layer": 9,
      "best_C": 1.0,
      "train": {
        "accuracy": 0.9842857142857143,
        "precision": 0.9067796610169492,
        "recall": 1.0,
        "f1": 0.9511111111111111
      },
      "val": {
        "accuracy": 0.8666666666666667,
        "precision": 0.52,
        "recall": 0.6190476190476191,
        "f1": 0.5652173913043478
      },
      "test": {
        "accuracy": 0.8533333333333334,
        "precision": 0.5416666666666666,
        "recall": 0.5416666666666666,
        "f1": 0.5416666666666666
      }
    },
    {
      "layer": 10,
      "best_C": 1.0,
      "train": {
        "accuracy": 0.9914285714285714,
        "precision": 0.9469026548672567,
        "recall": 1.0,
        "f1": 0.9727272727272728
      },
      "val": {
        "accuracy": 0.8533333333333334,
        "precision": 0.4827586206896552,
        "recall": 0.6666666666666666,
        "f1": 0.56
      },
      "test": {
        "accuracy": 0.8333333333333334,
        "precision": 0.48148148148148145,
        "recall": 0.5416666666666666,
        "f1": 0.5098039215686274
      }
    },
    {
      "layer": 11,
      "best_C": 1.0,
      "train": {
        "accuracy": 0.9985714285714286,
        "precision": 0.9907407407407407,
        "recall": 1.0,
        "f1": 0.9953488372093023
      },
      "val": {
        "accuracy": 0.86,
        "precision": 0.5,
        "recall": 0.7142857142857143,
        "f1": 0.5882352941176471
      },
      "test": {
        "accuracy": 0.84,
        "precision": 0.5,
        "recall": 0.5833333333333334,
        "f1": 0.5384615384615384
      }
    },
    {
      "layer": 12,
      "best_C": 1.0,
      "train": {
        "accuracy": 0.9985714285714286,
        "precision": 0.9907407407407407,
        "recall": 1.0,
        "f1": 0.9953488372093023
      },
      "val": {
        "accuracy": 0.8666666666666667,
        "precision": 0.52,
        "recall": 0.6190476190476191,
        "f1": 0.5652173913043478
      },
      "test": {
        "accuracy": 0.86,
        "precision": 0.5555555555555556,
        "recall": 0.625,
        "f1": 0.5882352941176471
      }
    },
    {
      "layer": 13,
      "best_C": 0.1,
      "train": {
        "accuracy": 0.9757142857142858,
        "precision": 0.8629032258064516,
        "recall": 1.0,
        "f1": 0.9264069264069265
      },
      "val": {
        "accuracy": 0.8533333333333334,
        "precision": 0.48484848484848486,
        "recall": 0.7619047619047619,
        "f1": 0.5925925925925926
      },
      "test": {
        "accuracy": 0.8733333333333333,
        "precision": 0.5862068965517241,
        "recall": 0.7083333333333334,
        "f1": 0.6415094339622641
      }
    },
    {
      "layer": 14,
      "best_C": 0.1,
      "train": {
        "accuracy": 0.9928571428571429,
        "precision": 0.9553571428571429,
        "recall": 1.0,
        "f1": 0.9771689497716894
      },
      "val": {
        "accuracy": 0.86,
        "precision": 0.5,
        "recall": 0.7142857142857143,
        "f1": 0.5882352941176471
      },
      "test": {
        "accuracy": 0.8466666666666667,
        "precision": 0.5172413793103449,
        "recall": 0.625,
        "f1": 0.5660377358490566
      }
    },
    {
      "layer": 15,
      "best_C": 0.1,
      "train": {
        "accuracy": 0.9942857142857143,
        "precision": 0.963963963963964,
        "recall": 1.0,
        "f1": 0.981651376146789
      },
      "val": {
        "accuracy": 0.8666666666666667,
        "precision": 0.5172413793103449,
        "recall": 0.7142857142857143,
        "f1": 0.6
      },
      "test": {
        "accuracy": 0.8733333333333333,
        "precision": 0.6,
        "recall": 0.625,
        "f1": 0.6122448979591837
      }
    },
    {
      "layer": 16,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.9471428571428572,
        "precision": 0.7430555555555556,
        "recall": 1.0,
        "f1": 0.852589641434263
      },
      "val": {
        "accuracy": 0.8733333333333333,
        "precision": 0.5294117647058824,
        "recall": 0.8571428571428571,
        "f1": 0.6545454545454545
      },
      "test": {
        "accuracy": 0.8666666666666667,
        "precision": 0.5666666666666667,
        "recall": 0.7083333333333334,
        "f1": 0.6296296296296297
      }
    },
    {
      "layer": 17,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.9585714285714285,
        "precision": 0.7867647058823529,
        "recall": 1.0,
        "f1": 0.8806584362139918
      },
      "val": {
        "accuracy": 0.8933333333333333,
        "precision": 0.5862068965517241,
        "recall": 0.8095238095238095,
        "f1": 0.68
      },
      "test": {
        "accuracy": 0.8733333333333333,
        "precision": 0.5925925925925926,
        "recall": 0.6666666666666666,
        "f1": 0.6274509803921569
      }
    },
    {
      "layer": 18,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.9671428571428572,
        "precision": 0.823076923076923,
        "recall": 1.0,
        "f1": 0.9029535864978903
      },
      "val": {
        "accuracy": 0.9066666666666666,
        "precision": 0.6296296296296297,
        "recall": 0.8095238095238095,
        "f1": 0.7083333333333334
      },
      "test": {
        "accuracy": 0.8866666666666667,
        "precision": 0.64,
        "recall": 0.6666666666666666,
        "f1": 0.6530612244897959
      }
    },
    {
      "layer": 19,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.9771428571428571,
        "precision": 0.8699186991869918,
        "recall": 1.0,
        "f1": 0.9304347826086956
      },
      "val": {
        "accuracy": 0.8933333333333333,
        "precision": 0.6,
        "recall": 0.7142857142857143,
        "f1": 0.6521739130434783
      },
      "test": {
        "accuracy": 0.88,
        "precision": 0.6071428571428571,
        "recall": 0.7083333333333334,
        "f1": 0.6538461538461539
      }
    },
    {
      "layer": 20,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.9814285714285714,
        "precision": 0.8916666666666667,
        "recall": 1.0,
        "f1": 0.9427312775330396
      },
      "val": {
        "accuracy": 0.8866666666666667,
        "precision": 0.5769230769230769,
        "recall": 0.7142857142857143,
        "f1": 0.6382978723404256
      },
      "test": {
        "accuracy": 0.8866666666666667,
        "precision": 0.6296296296296297,
        "recall": 0.7083333333333334,
        "f1": 0.6666666666666666
      }
    },
    {
      "layer": 21,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.9885714285714285,
        "precision": 0.9304347826086956,
        "recall": 1.0,
        "f1": 0.963963963963964
      },
      "val": {
        "accuracy": 0.8866666666666667,
        "precision": 0.5769230769230769,
        "recall": 0.7142857142857143,
        "f1": 0.6382978723404256
      },
      "test": {
        "accuracy": 0.8933333333333333,
        "precision": 0.6538461538461539,
        "recall": 0.7083333333333334,
        "f1": 0.68
      }
    },
    {
      "layer": 22,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.9928571428571429,
        "precision": 0.9553571428571429,
        "recall": 1.0,
        "f1": 0.9771689497716894
      },
      "val": {
        "accuracy": 0.8866666666666667,
        "precision": 0.5833333333333334,
        "recall": 0.6666666666666666,
        "f1": 0.6222222222222222
      },
      "test": {
        "accuracy": 0.8866666666666667,
        "precision": 0.6296296296296297,
        "recall": 0.7083333333333334,
        "f1": 0.6666666666666666
      }
    },
    {
      "layer": 23,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.9942857142857143,
        "precision": 0.963963963963964,
        "recall": 1.0,
        "f1": 0.981651376146789
      },
      "val": {
        "accuracy": 0.8933333333333333,
        "precision": 0.6086956521739131,
        "recall": 0.6666666666666666,
        "f1": 0.6363636363636364
      },
      "test": {
        "accuracy": 0.8933333333333333,
        "precision": 0.6428571428571429,
        "recall": 0.75,
        "f1": 0.6923076923076923
      }
    },
    {
      "layer": 24,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.9971428571428571,
        "precision": 0.981651376146789,
        "recall": 1.0,
        "f1": 0.9907407407407407
      },
      "val": {
        "accuracy": 0.8866666666666667,
        "precision": 0.5833333333333334,
        "recall": 0.6666666666666666,
        "f1": 0.6222222222222222
      },
      "test": {
        "accuracy": 0.9,
        "precision": 0.6666666666666666,
        "recall": 0.75,
        "f1": 0.7058823529411765
      }
    },
    {
      "layer": 25,
      "best_C": 0.1,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.9,
        "precision": 0.6363636363636364,
        "recall": 0.6666666666666666,
        "f1": 0.6511627906976745
      },
      "test": {
        "accuracy": 0.8933333333333333,
        "precision": 0.6428571428571429,
        "recall": 0.75,
        "f1": 0.6923076923076923
      }
    },
    {
      "layer": 26,
      "best_C": 0.01,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.9,
        "precision": 0.625,
        "recall": 0.7142857142857143,
        "f1": 0.6666666666666666
      },
      "test": {
        "accuracy": 0.8933333333333333,
        "precision": 0.6538461538461539,
        "recall": 0.7083333333333334,
        "f1": 0.68
      }
    },
    {
      "layer": 27,
      "best_C": 0.01,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.8933333333333333,
        "precision": 0.6,
        "recall": 0.7142857142857143,
        "f1": 0.6521739130434783
      },
      "test": {
        "accuracy": 0.8866666666666667,
        "precision": 0.64,
        "recall": 0.6666666666666666,
        "f1": 0.6530612244897959
      }
    },
    {
      "layer": 28,
      "best_C": 0.01,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.8933333333333333,
        "precision": 0.6,
        "recall": 0.7142857142857143,
        "f1": 0.6521739130434783
      },
      "test": {
        "accuracy": 0.9,
        "precision": 0.6956521739130435,
        "recall": 0.6666666666666666,
        "f1": 0.6808510638297872
      }
    },
    {
      "layer": 29,
      "best_C": 1.0,
      "train": {
        "accuracy": 0.98,
        "precision": 0.8842975206611571,
        "recall": 1.0,
        "f1": 0.9385964912280702
      },
      "val": {
        "accuracy": 0.88,
        "precision": 0.5517241379310345,
        "recall": 0.7619047619047619,
        "f1": 0.64
      },
      "test": {
        "accuracy": 0.86,
        "precision": 0.5517241379310345,
        "recall": 0.6666666666666666,
        "f1": 0.6037735849056604
      }
    }
  ]
}