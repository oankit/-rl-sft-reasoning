{
  "model_name": "allenai/Olmo-3-7B-Think-DPO",
  "n_layers": 32,
  "n_train": 700,
  "n_val": 150,
  "n_test": 150,
  "n_total": 1000,
  "n_correct": 867,
  "n_incorrect": 133,
  "correct_ratio": 86.7,
  "class_weight": "balanced",
  "indices_path": "/Users/antyabharahman/Downloads/Personal/final_research/paper_codebase/-rl-sft-reasoning/experiment_code/layerwise_linear_probe/balanced_outputs/584/olmo3/balanced_indices_Olmo-3-7B-Think-DPO.json",
  "probe_config": {
    "cv_folds": 5,
    "C_range": [
      0.01,
      0.1,
      1.0,
      10.0,
      100.0
    ],
    "max_iter": 5000,
    "random_state": 42,
    "solver": "lbfgs"
  },
  "layer_results": [
    {
      "layer": 0,
      "best_C": 100.0,
      "train": {
        "accuracy": 0.7728571428571429,
        "precision": 0.9588477366255144,
        "recall": 0.7702479338842976,
        "f1": 0.854262144821265
      },
      "val": {
        "accuracy": 0.76,
        "precision": 0.9791666666666666,
        "recall": 0.734375,
        "f1": 0.8392857142857143
      },
      "test": {
        "accuracy": 0.7666666666666667,
        "precision": 0.9805825242718447,
        "recall": 0.753731343283582,
        "f1": 0.8523206751054853
      }
    },
    {
      "layer": 1,
      "best_C": 100.0,
      "train": {
        "accuracy": 0.8285714285714286,
        "precision": 0.9801980198019802,
        "recall": 0.8181818181818182,
        "f1": 0.8918918918918919
      },
      "val": {
        "accuracy": 0.7733333333333333,
        "precision": 0.97,
        "recall": 0.7578125,
        "f1": 0.8508771929824561
      },
      "test": {
        "accuracy": 0.7866666666666666,
        "precision": 0.9722222222222222,
        "recall": 0.7835820895522388,
        "f1": 0.8677685950413223
      }
    },
    {
      "layer": 2,
      "best_C": 100.0,
      "train": {
        "accuracy": 0.8628571428571429,
        "precision": 0.9847619047619047,
        "recall": 0.8545454545454545,
        "f1": 0.9150442477876106
      },
      "val": {
        "accuracy": 0.7866666666666666,
        "precision": 0.9615384615384616,
        "recall": 0.78125,
        "f1": 0.8620689655172413
      },
      "test": {
        "accuracy": 0.82,
        "precision": 0.9652173913043478,
        "recall": 0.8283582089552238,
        "f1": 0.891566265060241
      }
    },
    {
      "layer": 3,
      "best_C": 100.0,
      "train": {
        "accuracy": 0.9214285714285714,
        "precision": 0.9963898916967509,
        "recall": 0.912396694214876,
        "f1": 0.9525452976704055
      },
      "val": {
        "accuracy": 0.84,
        "precision": 0.9642857142857143,
        "recall": 0.84375,
        "f1": 0.9
      },
      "test": {
        "accuracy": 0.8733333333333333,
        "precision": 0.96,
        "recall": 0.8955223880597015,
        "f1": 0.9266409266409267
      }
    },
    {
      "layer": 4,
      "best_C": 100.0,
      "train": {
        "accuracy": 0.9371428571428572,
        "precision": 0.9982238010657194,
        "recall": 0.9289256198347108,
        "f1": 0.9623287671232876
      },
      "val": {
        "accuracy": 0.8733333333333333,
        "precision": 0.957983193277311,
        "recall": 0.890625,
        "f1": 0.9230769230769231
      },
      "test": {
        "accuracy": 0.86,
        "precision": 0.952,
        "recall": 0.8880597014925373,
        "f1": 0.918918918918919
      }
    },
    {
      "layer": 5,
      "best_C": 100.0,
      "train": {
        "accuracy": 0.96,
        "precision": 1.0,
        "recall": 0.9537190082644628,
        "f1": 0.9763113367174281
      },
      "val": {
        "accuracy": 0.8666666666666667,
        "precision": 0.95,
        "recall": 0.890625,
        "f1": 0.9193548387096774
      },
      "test": {
        "accuracy": 0.8666666666666667,
        "precision": 0.9453125,
        "recall": 0.9029850746268657,
        "f1": 0.9236641221374046
      }
    },
    {
      "layer": 6,
      "best_C": 100.0,
      "train": {
        "accuracy": 0.9728571428571429,
        "precision": 1.0,
        "recall": 0.968595041322314,
        "f1": 0.984047019311503
      },
      "val": {
        "accuracy": 0.8733333333333333,
        "precision": 0.9504132231404959,
        "recall": 0.8984375,
        "f1": 0.9236947791164659
      },
      "test": {
        "accuracy": 0.88,
        "precision": 0.953125,
        "recall": 0.9104477611940298,
        "f1": 0.9312977099236641
      }
    },
    {
      "layer": 7,
      "best_C": 100.0,
      "train": {
        "accuracy": 0.99,
        "precision": 1.0,
        "recall": 0.9884297520661157,
        "f1": 0.9941812136325852
      },
      "val": {
        "accuracy": 0.8533333333333334,
        "precision": 0.9416666666666667,
        "recall": 0.8828125,
        "f1": 0.9112903225806451
      },
      "test": {
        "accuracy": 0.86,
        "precision": 0.952,
        "recall": 0.8880597014925373,
        "f1": 0.918918918918919
      }
    },
    {
      "layer": 8,
      "best_C": 100.0,
      "train": {
        "accuracy": 0.9985714285714286,
        "precision": 1.0,
        "recall": 0.9983471074380166,
        "f1": 0.9991728701406121
      },
      "val": {
        "accuracy": 0.9,
        "precision": 0.952,
        "recall": 0.9296875,
        "f1": 0.9407114624505929
      },
      "test": {
        "accuracy": 0.88,
        "precision": 0.953125,
        "recall": 0.9104477611940298,
        "f1": 0.9312977099236641
      }
    },
    {
      "layer": 9,
      "best_C": 100.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.9133333333333333,
        "precision": 0.952755905511811,
        "recall": 0.9453125,
        "f1": 0.9490196078431372
      },
      "test": {
        "accuracy": 0.8933333333333333,
        "precision": 0.946969696969697,
        "recall": 0.9328358208955224,
        "f1": 0.9398496240601504
      }
    },
    {
      "layer": 10,
      "best_C": 100.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.9,
        "precision": 0.952,
        "recall": 0.9296875,
        "f1": 0.9407114624505929
      },
      "test": {
        "accuracy": 0.9,
        "precision": 0.9612403100775194,
        "recall": 0.9253731343283582,
        "f1": 0.9429657794676806
      }
    },
    {
      "layer": 11,
      "best_C": 100.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.9,
        "precision": 0.952,
        "recall": 0.9296875,
        "f1": 0.9407114624505929
      },
      "test": {
        "accuracy": 0.9066666666666666,
        "precision": 0.9615384615384616,
        "recall": 0.9328358208955224,
        "f1": 0.946969696969697
      }
    },
    {
      "layer": 12,
      "best_C": 100.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.8933333333333333,
        "precision": 0.9516129032258065,
        "recall": 0.921875,
        "f1": 0.9365079365079365
      },
      "test": {
        "accuracy": 0.9133333333333333,
        "precision": 0.9689922480620154,
        "recall": 0.9328358208955224,
        "f1": 0.9505703422053232
      }
    },
    {
      "layer": 13,
      "best_C": 100.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.8866666666666667,
        "precision": 0.9512195121951219,
        "recall": 0.9140625,
        "f1": 0.9322709163346613
      },
      "test": {
        "accuracy": 0.9266666666666666,
        "precision": 0.9694656488549618,
        "recall": 0.9477611940298507,
        "f1": 0.9584905660377359
      }
    },
    {
      "layer": 14,
      "best_C": 100.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.9,
        "precision": 0.952,
        "recall": 0.9296875,
        "f1": 0.9407114624505929
      },
      "test": {
        "accuracy": 0.9333333333333333,
        "precision": 0.9696969696969697,
        "recall": 0.9552238805970149,
        "f1": 0.9624060150375939
      }
    },
    {
      "layer": 15,
      "best_C": 100.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.92,
        "precision": 0.953125,
        "recall": 0.953125,
        "f1": 0.953125
      },
      "test": {
        "accuracy": 0.94,
        "precision": 0.9770992366412213,
        "recall": 0.9552238805970149,
        "f1": 0.9660377358490566
      }
    },
    {
      "layer": 16,
      "best_C": 100.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.9066666666666666,
        "precision": 0.9523809523809523,
        "recall": 0.9375,
        "f1": 0.9448818897637795
      },
      "test": {
        "accuracy": 0.9466666666666667,
        "precision": 0.9632352941176471,
        "recall": 0.9776119402985075,
        "f1": 0.9703703703703703
      }
    },
    {
      "layer": 17,
      "best_C": 10.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.9333333333333333,
        "precision": 0.9609375,
        "recall": 0.9609375,
        "f1": 0.9609375
      },
      "test": {
        "accuracy": 0.94,
        "precision": 0.9629629629629629,
        "recall": 0.9701492537313433,
        "f1": 0.966542750929368
      }
    },
    {
      "layer": 18,
      "best_C": 100.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.9133333333333333,
        "precision": 0.96,
        "recall": 0.9375,
        "f1": 0.9486166007905138
      },
      "test": {
        "accuracy": 0.9333333333333333,
        "precision": 0.9626865671641791,
        "recall": 0.9626865671641791,
        "f1": 0.9626865671641791
      }
    },
    {
      "layer": 19,
      "best_C": 100.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.8933333333333333,
        "precision": 0.9444444444444444,
        "recall": 0.9296875,
        "f1": 0.937007874015748
      },
      "test": {
        "accuracy": 0.8733333333333333,
        "precision": 0.9457364341085271,
        "recall": 0.9104477611940298,
        "f1": 0.9277566539923955
      }
    },
    {
      "layer": 20,
      "best_C": 10.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.9066666666666666,
        "precision": 0.9453125,
        "recall": 0.9453125,
        "f1": 0.9453125
      },
      "test": {
        "accuracy": 0.8733333333333333,
        "precision": 0.9457364341085271,
        "recall": 0.9104477611940298,
        "f1": 0.9277566539923955
      }
    },
    {
      "layer": 21,
      "best_C": 100.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.9066666666666666,
        "precision": 0.9453125,
        "recall": 0.9453125,
        "f1": 0.9453125
      },
      "test": {
        "accuracy": 0.8866666666666667,
        "precision": 0.9534883720930233,
        "recall": 0.917910447761194,
        "f1": 0.935361216730038
      }
    },
    {
      "layer": 22,
      "best_C": 100.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.92,
        "precision": 0.9461538461538461,
        "recall": 0.9609375,
        "f1": 0.9534883720930233
      },
      "test": {
        "accuracy": 0.8733333333333333,
        "precision": 0.9457364341085271,
        "recall": 0.9104477611940298,
        "f1": 0.9277566539923955
      }
    },
    {
      "layer": 23,
      "best_C": 10.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.8866666666666667,
        "precision": 0.9236641221374046,
        "recall": 0.9453125,
        "f1": 0.9343629343629344
      },
      "test": {
        "accuracy": 0.88,
        "precision": 0.9461538461538461,
        "recall": 0.917910447761194,
        "f1": 0.9318181818181818
      }
    },
    {
      "layer": 24,
      "best_C": 10.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.8533333333333334,
        "precision": 0.9206349206349206,
        "recall": 0.90625,
        "f1": 0.9133858267716536
      },
      "test": {
        "accuracy": 0.9066666666666666,
        "precision": 0.9477611940298507,
        "recall": 0.9477611940298507,
        "f1": 0.9477611940298507
      }
    },
    {
      "layer": 25,
      "best_C": 1.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.84,
        "precision": 0.9126984126984127,
        "recall": 0.8984375,
        "f1": 0.905511811023622
      },
      "test": {
        "accuracy": 0.9133333333333333,
        "precision": 0.9618320610687023,
        "recall": 0.9402985074626866,
        "f1": 0.9509433962264151
      }
    },
    {
      "layer": 26,
      "best_C": 100.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.8466666666666667,
        "precision": 0.9133858267716536,
        "recall": 0.90625,
        "f1": 0.9098039215686274
      },
      "test": {
        "accuracy": 0.9066666666666666,
        "precision": 0.9411764705882353,
        "recall": 0.9552238805970149,
        "f1": 0.9481481481481482
      }
    },
    {
      "layer": 27,
      "best_C": 100.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.84,
        "precision": 0.90625,
        "recall": 0.90625,
        "f1": 0.90625
      },
      "test": {
        "accuracy": 0.9,
        "precision": 0.9407407407407408,
        "recall": 0.9477611940298507,
        "f1": 0.9442379182156134
      }
    },
    {
      "layer": 28,
      "best_C": 100.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.8466666666666667,
        "precision": 0.9133858267716536,
        "recall": 0.90625,
        "f1": 0.9098039215686274
      },
      "test": {
        "accuracy": 0.88,
        "precision": 0.9393939393939394,
        "recall": 0.9253731343283582,
        "f1": 0.9323308270676691
      }
    },
    {
      "layer": 29,
      "best_C": 10.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.86,
        "precision": 0.9212598425196851,
        "recall": 0.9140625,
        "f1": 0.9176470588235294
      },
      "test": {
        "accuracy": 0.8733333333333333,
        "precision": 0.9389312977099237,
        "recall": 0.917910447761194,
        "f1": 0.9283018867924528
      }
    },
    {
      "layer": 30,
      "best_C": 10.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.86,
        "precision": 0.9212598425196851,
        "recall": 0.9140625,
        "f1": 0.9176470588235294
      },
      "test": {
        "accuracy": 0.8733333333333333,
        "precision": 0.952755905511811,
        "recall": 0.9029850746268657,
        "f1": 0.9272030651340997
      }
    },
    {
      "layer": 31,
      "best_C": 1.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.8266666666666667,
        "precision": 0.9047619047619048,
        "recall": 0.890625,
        "f1": 0.8976377952755905
      },
      "test": {
        "accuracy": 0.86,
        "precision": 0.937984496124031,
        "recall": 0.9029850746268657,
        "f1": 0.9201520912547528
      }
    }
  ]
}