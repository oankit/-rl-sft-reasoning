{
  "model_name": "deepseek-ai/deepseek-math-7b-instruct",
  "n_layers": 30,
  "n_train": 700,
  "n_val": 150,
  "n_test": 150,
  "n_total": 1000,
  "n_correct": 490,
  "n_incorrect": 510,
  "correct_ratio": 49.0,
  "class_weight": "balanced",
  "indices_path": "/Users/antyabharahman/Downloads/Personal/final_research/paper_codebase/-rl-sft-reasoning/experiment_code/layerwise_linear_probe/balanced_outputs/584/deepseek/balanced_indices_deepseek-math-7b-instruct.json",
  "probe_config": {
    "cv_folds": 5,
    "C_range": [
      0.01,
      0.1,
      1.0,
      10.0,
      100.0
    ],
    "max_iter": 5000,
    "random_state": 42,
    "solver": "lbfgs"
  },
  "layer_results": [
    {
      "layer": 0,
      "best_C": 10.0,
      "train": {
        "accuracy": 0.6542857142857142,
        "precision": 0.6193853427895981,
        "recall": 0.7638483965014577,
        "f1": 0.6840731070496083
      },
      "val": {
        "accuracy": 0.5666666666666667,
        "precision": 0.5729166666666666,
        "recall": 0.6962025316455697,
        "f1": 0.6285714285714286
      },
      "test": {
        "accuracy": 0.6933333333333334,
        "precision": 0.6341463414634146,
        "recall": 0.7647058823529411,
        "f1": 0.6933333333333334
      }
    },
    {
      "layer": 1,
      "best_C": 10.0,
      "train": {
        "accuracy": 0.6642857142857143,
        "precision": 0.6285714285714286,
        "recall": 0.7696793002915452,
        "f1": 0.6920052424639581
      },
      "val": {
        "accuracy": 0.54,
        "precision": 0.5531914893617021,
        "recall": 0.6582278481012658,
        "f1": 0.6011560693641619
      },
      "test": {
        "accuracy": 0.7,
        "precision": 0.6419753086419753,
        "recall": 0.7647058823529411,
        "f1": 0.697986577181208
      }
    },
    {
      "layer": 2,
      "best_C": 1.0,
      "train": {
        "accuracy": 0.6571428571428571,
        "precision": 0.62004662004662,
        "recall": 0.7755102040816326,
        "f1": 0.689119170984456
      },
      "val": {
        "accuracy": 0.56,
        "precision": 0.5643564356435643,
        "recall": 0.7215189873417721,
        "f1": 0.6333333333333333
      },
      "test": {
        "accuracy": 0.68,
        "precision": 0.625,
        "recall": 0.7352941176470589,
        "f1": 0.6756756756756757
      }
    },
    {
      "layer": 3,
      "best_C": 10.0,
      "train": {
        "accuracy": 0.7642857142857142,
        "precision": 0.7270408163265306,
        "recall": 0.8309037900874635,
        "f1": 0.7755102040816326
      },
      "val": {
        "accuracy": 0.5933333333333334,
        "precision": 0.6022727272727273,
        "recall": 0.6708860759493671,
        "f1": 0.6347305389221557
      },
      "test": {
        "accuracy": 0.6866666666666666,
        "precision": 0.6329113924050633,
        "recall": 0.7352941176470589,
        "f1": 0.6802721088435374
      }
    },
    {
      "layer": 4,
      "best_C": 1.0,
      "train": {
        "accuracy": 0.7028571428571428,
        "precision": 0.6642335766423357,
        "recall": 0.7959183673469388,
        "f1": 0.7241379310344828
      },
      "val": {
        "accuracy": 0.5533333333333333,
        "precision": 0.5638297872340425,
        "recall": 0.6708860759493671,
        "f1": 0.6127167630057804
      },
      "test": {
        "accuracy": 0.6933333333333334,
        "precision": 0.627906976744186,
        "recall": 0.7941176470588235,
        "f1": 0.7012987012987013
      }
    },
    {
      "layer": 5,
      "best_C": 1.0,
      "train": {
        "accuracy": 0.7114285714285714,
        "precision": 0.6723716381418093,
        "recall": 0.8017492711370262,
        "f1": 0.7313829787234043
      },
      "val": {
        "accuracy": 0.54,
        "precision": 0.5543478260869565,
        "recall": 0.6455696202531646,
        "f1": 0.5964912280701754
      },
      "test": {
        "accuracy": 0.6933333333333334,
        "precision": 0.627906976744186,
        "recall": 0.7941176470588235,
        "f1": 0.7012987012987013
      }
    },
    {
      "layer": 6,
      "best_C": 0.1,
      "train": {
        "accuracy": 0.6585714285714286,
        "precision": 0.6155555555555555,
        "recall": 0.8075801749271136,
        "f1": 0.6986128625472888
      },
      "val": {
        "accuracy": 0.5533333333333333,
        "precision": 0.5566037735849056,
        "recall": 0.7468354430379747,
        "f1": 0.6378378378378379
      },
      "test": {
        "accuracy": 0.7066666666666667,
        "precision": 0.6363636363636364,
        "recall": 0.8235294117647058,
        "f1": 0.717948717948718
      }
    },
    {
      "layer": 7,
      "best_C": 0.1,
      "train": {
        "accuracy": 0.6785714285714286,
        "precision": 0.6311111111111111,
        "recall": 0.8279883381924198,
        "f1": 0.7162673392181589
      },
      "val": {
        "accuracy": 0.5466666666666666,
        "precision": 0.5523809523809524,
        "recall": 0.7341772151898734,
        "f1": 0.6304347826086957
      },
      "test": {
        "accuracy": 0.72,
        "precision": 0.6511627906976745,
        "recall": 0.8235294117647058,
        "f1": 0.7272727272727273
      }
    },
    {
      "layer": 8,
      "best_C": 0.1,
      "train": {
        "accuracy": 0.6771428571428572,
        "precision": 0.6320541760722348,
        "recall": 0.8163265306122449,
        "f1": 0.712468193384224
      },
      "val": {
        "accuracy": 0.58,
        "precision": 0.5754716981132075,
        "recall": 0.7721518987341772,
        "f1": 0.6594594594594595
      },
      "test": {
        "accuracy": 0.7066666666666667,
        "precision": 0.6363636363636364,
        "recall": 0.8235294117647058,
        "f1": 0.717948717948718
      }
    },
    {
      "layer": 9,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.6457142857142857,
        "precision": 0.6048565121412803,
        "recall": 0.7988338192419825,
        "f1": 0.6884422110552764
      },
      "val": {
        "accuracy": 0.5533333333333333,
        "precision": 0.5555555555555556,
        "recall": 0.759493670886076,
        "f1": 0.6417112299465241
      },
      "test": {
        "accuracy": 0.7,
        "precision": 0.6292134831460674,
        "recall": 0.8235294117647058,
        "f1": 0.7133757961783439
      }
    },
    {
      "layer": 10,
      "best_C": 0.1,
      "train": {
        "accuracy": 0.71,
        "precision": 0.6650943396226415,
        "recall": 0.8221574344023324,
        "f1": 0.7353324641460235
      },
      "val": {
        "accuracy": 0.5533333333333333,
        "precision": 0.56,
        "recall": 0.7088607594936709,
        "f1": 0.6256983240223464
      },
      "test": {
        "accuracy": 0.7,
        "precision": 0.6352941176470588,
        "recall": 0.7941176470588235,
        "f1": 0.7058823529411765
      }
    },
    {
      "layer": 11,
      "best_C": 0.1,
      "train": {
        "accuracy": 0.7371428571428571,
        "precision": 0.6897374701670644,
        "recall": 0.8425655976676385,
        "f1": 0.7585301837270341
      },
      "val": {
        "accuracy": 0.5733333333333334,
        "precision": 0.5789473684210527,
        "recall": 0.6962025316455697,
        "f1": 0.632183908045977
      },
      "test": {
        "accuracy": 0.7,
        "precision": 0.6352941176470588,
        "recall": 0.7941176470588235,
        "f1": 0.7058823529411765
      }
    },
    {
      "layer": 12,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.68,
        "precision": 0.6319290465631929,
        "recall": 0.8309037900874635,
        "f1": 0.7178841309823678
      },
      "val": {
        "accuracy": 0.58,
        "precision": 0.5754716981132075,
        "recall": 0.7721518987341772,
        "f1": 0.6594594594594595
      },
      "test": {
        "accuracy": 0.6933333333333334,
        "precision": 0.625,
        "recall": 0.8088235294117647,
        "f1": 0.7051282051282052
      }
    },
    {
      "layer": 13,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.6871428571428572,
        "precision": 0.6402714932126696,
        "recall": 0.8250728862973761,
        "f1": 0.7210191082802547
      },
      "val": {
        "accuracy": 0.56,
        "precision": 0.5643564356435643,
        "recall": 0.7215189873417721,
        "f1": 0.6333333333333333
      },
      "test": {
        "accuracy": 0.7133333333333334,
        "precision": 0.6436781609195402,
        "recall": 0.8235294117647058,
        "f1": 0.7225806451612903
      }
    },
    {
      "layer": 14,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.6885714285714286,
        "precision": 0.6417233560090703,
        "recall": 0.8250728862973761,
        "f1": 0.7219387755102041
      },
      "val": {
        "accuracy": 0.5733333333333334,
        "precision": 0.5742574257425742,
        "recall": 0.7341772151898734,
        "f1": 0.6444444444444445
      },
      "test": {
        "accuracy": 0.7,
        "precision": 0.632183908045977,
        "recall": 0.8088235294117647,
        "f1": 0.7096774193548387
      }
    },
    {
      "layer": 15,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.71,
        "precision": 0.6620370370370371,
        "recall": 0.8338192419825073,
        "f1": 0.7380645161290322
      },
      "val": {
        "accuracy": 0.5933333333333334,
        "precision": 0.59375,
        "recall": 0.7215189873417721,
        "f1": 0.6514285714285715
      },
      "test": {
        "accuracy": 0.7,
        "precision": 0.632183908045977,
        "recall": 0.8088235294117647,
        "f1": 0.7096774193548387
      }
    },
    {
      "layer": 16,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.7371428571428571,
        "precision": 0.6906474820143885,
        "recall": 0.8396501457725948,
        "f1": 0.7578947368421053
      },
      "val": {
        "accuracy": 0.5533333333333333,
        "precision": 0.5638297872340425,
        "recall": 0.6708860759493671,
        "f1": 0.6127167630057804
      },
      "test": {
        "accuracy": 0.6866666666666666,
        "precision": 0.6329113924050633,
        "recall": 0.7352941176470589,
        "f1": 0.6802721088435374
      }
    },
    {
      "layer": 17,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.7557142857142857,
        "precision": 0.7139303482587065,
        "recall": 0.8367346938775511,
        "f1": 0.7704697986577181
      },
      "val": {
        "accuracy": 0.5733333333333334,
        "precision": 0.5862068965517241,
        "recall": 0.6455696202531646,
        "f1": 0.6144578313253012
      },
      "test": {
        "accuracy": 0.6733333333333333,
        "precision": 0.620253164556962,
        "recall": 0.7205882352941176,
        "f1": 0.6666666666666666
      }
    },
    {
      "layer": 18,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.7714285714285715,
        "precision": 0.732824427480916,
        "recall": 0.8396501457725948,
        "f1": 0.782608695652174
      },
      "val": {
        "accuracy": 0.5466666666666666,
        "precision": 0.5733333333333334,
        "recall": 0.5443037974683544,
        "f1": 0.5584415584415584
      },
      "test": {
        "accuracy": 0.6866666666666666,
        "precision": 0.6363636363636364,
        "recall": 0.7205882352941176,
        "f1": 0.6758620689655173
      }
    },
    {
      "layer": 19,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.82,
        "precision": 0.7924528301886793,
        "recall": 0.8571428571428571,
        "f1": 0.8235294117647058
      },
      "val": {
        "accuracy": 0.5666666666666667,
        "precision": 0.5945945945945946,
        "recall": 0.5569620253164557,
        "f1": 0.5751633986928104
      },
      "test": {
        "accuracy": 0.6733333333333333,
        "precision": 0.6376811594202898,
        "recall": 0.6470588235294118,
        "f1": 0.6423357664233577
      }
    },
    {
      "layer": 20,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.8428571428571429,
        "precision": 0.8174386920980926,
        "recall": 0.8746355685131195,
        "f1": 0.8450704225352113
      },
      "val": {
        "accuracy": 0.5466666666666666,
        "precision": 0.582089552238806,
        "recall": 0.4936708860759494,
        "f1": 0.5342465753424658
      },
      "test": {
        "accuracy": 0.66,
        "precision": 0.6268656716417911,
        "recall": 0.6176470588235294,
        "f1": 0.6222222222222222
      }
    },
    {
      "layer": 21,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.8514285714285714,
        "precision": 0.8238482384823849,
        "recall": 0.8862973760932945,
        "f1": 0.8539325842696629
      },
      "val": {
        "accuracy": 0.54,
        "precision": 0.5735294117647058,
        "recall": 0.4936708860759494,
        "f1": 0.5306122448979592
      },
      "test": {
        "accuracy": 0.64,
        "precision": 0.6129032258064516,
        "recall": 0.5588235294117647,
        "f1": 0.5846153846153846
      }
    },
    {
      "layer": 22,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.8842857142857142,
        "precision": 0.8598901098901099,
        "recall": 0.9125364431486881,
        "f1": 0.8854314002828855
      },
      "val": {
        "accuracy": 0.56,
        "precision": 0.6,
        "recall": 0.4936708860759494,
        "f1": 0.5416666666666666
      },
      "test": {
        "accuracy": 0.6266666666666667,
        "precision": 0.6,
        "recall": 0.5294117647058824,
        "f1": 0.5625
      }
    },
    {
      "layer": 23,
      "best_C": 100.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.5466666666666666,
        "precision": 0.5733333333333334,
        "recall": 0.5443037974683544,
        "f1": 0.5584415584415584
      },
      "test": {
        "accuracy": 0.6,
        "precision": 0.5645161290322581,
        "recall": 0.5147058823529411,
        "f1": 0.5384615384615384
      }
    },
    {
      "layer": 24,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.9357142857142857,
        "precision": 0.904891304347826,
        "recall": 0.9708454810495627,
        "f1": 0.9367088607594937
      },
      "val": {
        "accuracy": 0.56,
        "precision": 0.5866666666666667,
        "recall": 0.5569620253164557,
        "f1": 0.5714285714285714
      },
      "test": {
        "accuracy": 0.5933333333333334,
        "precision": 0.5573770491803278,
        "recall": 0.5,
        "f1": 0.5271317829457365
      }
    },
    {
      "layer": 25,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.9485714285714286,
        "precision": 0.925207756232687,
        "recall": 0.9737609329446064,
        "f1": 0.9488636363636364
      },
      "val": {
        "accuracy": 0.5733333333333334,
        "precision": 0.6,
        "recall": 0.569620253164557,
        "f1": 0.5844155844155844
      },
      "test": {
        "accuracy": 0.58,
        "precision": 0.5409836065573771,
        "recall": 0.4852941176470588,
        "f1": 0.5116279069767442
      }
    },
    {
      "layer": 26,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.9585714285714285,
        "precision": 0.9385474860335196,
        "recall": 0.9795918367346939,
        "f1": 0.9586305278174037
      },
      "val": {
        "accuracy": 0.54,
        "precision": 0.5714285714285714,
        "recall": 0.5063291139240507,
        "f1": 0.5369127516778524
      },
      "test": {
        "accuracy": 0.64,
        "precision": 0.6206896551724138,
        "recall": 0.5294117647058824,
        "f1": 0.5714285714285714
      }
    },
    {
      "layer": 27,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.9785714285714285,
        "precision": 0.9712643678160919,
        "recall": 0.9854227405247813,
        "f1": 0.9782923299565847
      },
      "val": {
        "accuracy": 0.58,
        "precision": 0.6176470588235294,
        "recall": 0.5316455696202531,
        "f1": 0.5714285714285714
      },
      "test": {
        "accuracy": 0.6733333333333333,
        "precision": 0.6507936507936508,
        "recall": 0.6029411764705882,
        "f1": 0.6259541984732825
      }
    },
    {
      "layer": 28,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.9885714285714285,
        "precision": 0.9855072463768116,
        "recall": 0.9912536443148688,
        "f1": 0.9883720930232558
      },
      "val": {
        "accuracy": 0.58,
        "precision": 0.6081081081081081,
        "recall": 0.569620253164557,
        "f1": 0.5882352941176471
      },
      "test": {
        "accuracy": 0.6933333333333334,
        "precision": 0.6833333333333333,
        "recall": 0.6029411764705882,
        "f1": 0.640625
      }
    },
    {
      "layer": 29,
      "best_C": 1.0,
      "train": {
        "accuracy": 0.85,
        "precision": 0.8164893617021277,
        "recall": 0.8950437317784257,
        "f1": 0.8539638386648123
      },
      "val": {
        "accuracy": 0.62,
        "precision": 0.6410256410256411,
        "recall": 0.6329113924050633,
        "f1": 0.6369426751592356
      },
      "test": {
        "accuracy": 0.7066666666666667,
        "precision": 0.6714285714285714,
        "recall": 0.6911764705882353,
        "f1": 0.6811594202898551
      }
    }
  ]
}