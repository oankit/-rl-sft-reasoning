{
  "model_name": "deepseek-ai/deepseek-math-7b-instruct",
  "n_layers": 30,
  "n_train": 700,
  "n_val": 150,
  "n_test": 150,
  "n_total": 1000,
  "n_correct": 364,
  "n_incorrect": 636,
  "correct_ratio": 36.4,
  "class_weight": "balanced",
  "indices_path": "/Users/antyabharahman/Downloads/Personal/final_research/paper_codebase/-rl-sft-reasoning/experiment_code/layerwise_linear_probe/balanced_outputs/884/deepseek/balanced_indices_deepseek-math-7b-instruct.json",
  "probe_config": {
    "cv_folds": 5,
    "C_range": [
      0.01,
      0.1,
      1.0,
      10.0,
      100.0
    ],
    "max_iter": 5000,
    "random_state": 42,
    "solver": "lbfgs"
  },
  "layer_results": [
    {
      "layer": 0,
      "best_C": 100.0,
      "train": {
        "accuracy": 0.7157142857142857,
        "precision": 0.5974025974025974,
        "recall": 0.7104247104247104,
        "f1": 0.6490299823633157
      },
      "val": {
        "accuracy": 0.6,
        "precision": 0.42857142857142855,
        "recall": 0.5294117647058824,
        "f1": 0.47368421052631576
      },
      "test": {
        "accuracy": 0.5733333333333334,
        "precision": 0.421875,
        "recall": 0.5,
        "f1": 0.4576271186440678
      }
    },
    {
      "layer": 1,
      "best_C": 100.0,
      "train": {
        "accuracy": 0.8357142857142857,
        "precision": 0.7465753424657534,
        "recall": 0.8416988416988417,
        "f1": 0.7912885662431942
      },
      "val": {
        "accuracy": 0.58,
        "precision": 0.39285714285714285,
        "recall": 0.43137254901960786,
        "f1": 0.411214953271028
      },
      "test": {
        "accuracy": 0.6133333333333333,
        "precision": 0.4642857142857143,
        "recall": 0.48148148148148145,
        "f1": 0.4727272727272727
      }
    },
    {
      "layer": 2,
      "best_C": 100.0,
      "train": {
        "accuracy": 0.8828571428571429,
        "precision": 0.8218181818181818,
        "recall": 0.8725868725868726,
        "f1": 0.846441947565543
      },
      "val": {
        "accuracy": 0.6,
        "precision": 0.42105263157894735,
        "recall": 0.47058823529411764,
        "f1": 0.4444444444444444
      },
      "test": {
        "accuracy": 0.6066666666666667,
        "precision": 0.45454545454545453,
        "recall": 0.46296296296296297,
        "f1": 0.45871559633027525
      }
    },
    {
      "layer": 3,
      "best_C": 10.0,
      "train": {
        "accuracy": 0.8228571428571428,
        "precision": 0.7335640138408305,
        "recall": 0.8185328185328186,
        "f1": 0.7737226277372263
      },
      "val": {
        "accuracy": 0.6133333333333333,
        "precision": 0.43636363636363634,
        "recall": 0.47058823529411764,
        "f1": 0.4528301886792453
      },
      "test": {
        "accuracy": 0.64,
        "precision": 0.5,
        "recall": 0.5925925925925926,
        "f1": 0.5423728813559322
      }
    },
    {
      "layer": 4,
      "best_C": 10.0,
      "train": {
        "accuracy": 0.8742857142857143,
        "precision": 0.8131868131868132,
        "recall": 0.8571428571428571,
        "f1": 0.8345864661654135
      },
      "val": {
        "accuracy": 0.5733333333333334,
        "precision": 0.39344262295081966,
        "recall": 0.47058823529411764,
        "f1": 0.42857142857142855
      },
      "test": {
        "accuracy": 0.64,
        "precision": 0.5,
        "recall": 0.5925925925925926,
        "f1": 0.5423728813559322
      }
    },
    {
      "layer": 5,
      "best_C": 10.0,
      "train": {
        "accuracy": 0.9028571428571428,
        "precision": 0.8398576512455516,
        "recall": 0.9111969111969112,
        "f1": 0.8740740740740741
      },
      "val": {
        "accuracy": 0.6,
        "precision": 0.42857142857142855,
        "recall": 0.5294117647058824,
        "f1": 0.47368421052631576
      },
      "test": {
        "accuracy": 0.56,
        "precision": 0.4090909090909091,
        "recall": 0.5,
        "f1": 0.45
      }
    },
    {
      "layer": 6,
      "best_C": 10.0,
      "train": {
        "accuracy": 0.9457142857142857,
        "precision": 0.9138576779026217,
        "recall": 0.9420849420849421,
        "f1": 0.9277566539923955
      },
      "val": {
        "accuracy": 0.58,
        "precision": 0.3888888888888889,
        "recall": 0.4117647058823529,
        "f1": 0.4
      },
      "test": {
        "accuracy": 0.6066666666666667,
        "precision": 0.45901639344262296,
        "recall": 0.5185185185185185,
        "f1": 0.48695652173913045
      }
    },
    {
      "layer": 7,
      "best_C": 100.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.5666666666666667,
        "precision": 0.37037037037037035,
        "recall": 0.39215686274509803,
        "f1": 0.38095238095238093
      },
      "test": {
        "accuracy": 0.6,
        "precision": 0.45588235294117646,
        "recall": 0.5740740740740741,
        "f1": 0.5081967213114754
      }
    },
    {
      "layer": 8,
      "best_C": 100.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.6133333333333333,
        "precision": 0.4426229508196721,
        "recall": 0.5294117647058824,
        "f1": 0.48214285714285715
      },
      "test": {
        "accuracy": 0.5733333333333334,
        "precision": 0.4264705882352941,
        "recall": 0.5370370370370371,
        "f1": 0.47540983606557374
      }
    },
    {
      "layer": 9,
      "best_C": 1.0,
      "train": {
        "accuracy": 0.91,
        "precision": 0.85,
        "recall": 0.918918918918919,
        "f1": 0.8831168831168831
      },
      "val": {
        "accuracy": 0.6133333333333333,
        "precision": 0.4222222222222222,
        "recall": 0.37254901960784315,
        "f1": 0.3958333333333333
      },
      "test": {
        "accuracy": 0.5933333333333334,
        "precision": 0.4461538461538462,
        "recall": 0.5370370370370371,
        "f1": 0.48739495798319327
      }
    },
    {
      "layer": 10,
      "best_C": 100.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.58,
        "precision": 0.36363636363636365,
        "recall": 0.3137254901960784,
        "f1": 0.3368421052631579
      },
      "test": {
        "accuracy": 0.6133333333333333,
        "precision": 0.4714285714285714,
        "recall": 0.6111111111111112,
        "f1": 0.532258064516129
      }
    },
    {
      "layer": 11,
      "best_C": 10.0,
      "train": {
        "accuracy": 0.9985714285714286,
        "precision": 0.9961538461538462,
        "recall": 1.0,
        "f1": 0.9980732177263969
      },
      "val": {
        "accuracy": 0.5866666666666667,
        "precision": 0.37209302325581395,
        "recall": 0.3137254901960784,
        "f1": 0.3404255319148936
      },
      "test": {
        "accuracy": 0.58,
        "precision": 0.43283582089552236,
        "recall": 0.5370370370370371,
        "f1": 0.4793388429752066
      }
    },
    {
      "layer": 12,
      "best_C": 10.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.6133333333333333,
        "precision": 0.41025641025641024,
        "recall": 0.3137254901960784,
        "f1": 0.35555555555555557
      },
      "test": {
        "accuracy": 0.54,
        "precision": 0.3880597014925373,
        "recall": 0.48148148148148145,
        "f1": 0.4297520661157025
      }
    },
    {
      "layer": 13,
      "best_C": 1.0,
      "train": {
        "accuracy": 0.9971428571428571,
        "precision": 0.9961389961389961,
        "recall": 0.9961389961389961,
        "f1": 0.9961389961389961
      },
      "val": {
        "accuracy": 0.5933333333333334,
        "precision": 0.391304347826087,
        "recall": 0.35294117647058826,
        "f1": 0.3711340206185567
      },
      "test": {
        "accuracy": 0.5666666666666667,
        "precision": 0.4,
        "recall": 0.4074074074074074,
        "f1": 0.4036697247706422
      }
    },
    {
      "layer": 14,
      "best_C": 10.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.5666666666666667,
        "precision": 0.34782608695652173,
        "recall": 0.3137254901960784,
        "f1": 0.32989690721649484
      },
      "test": {
        "accuracy": 0.56,
        "precision": 0.39655172413793105,
        "recall": 0.42592592592592593,
        "f1": 0.4107142857142857
      }
    },
    {
      "layer": 15,
      "best_C": 0.1,
      "train": {
        "accuracy": 0.9528571428571428,
        "precision": 0.9094202898550725,
        "recall": 0.9691119691119691,
        "f1": 0.9383177570093458
      },
      "val": {
        "accuracy": 0.5933333333333334,
        "precision": 0.391304347826087,
        "recall": 0.35294117647058826,
        "f1": 0.3711340206185567
      },
      "test": {
        "accuracy": 0.5933333333333334,
        "precision": 0.4406779661016949,
        "recall": 0.48148148148148145,
        "f1": 0.46017699115044247
      }
    },
    {
      "layer": 16,
      "best_C": 0.1,
      "train": {
        "accuracy": 0.97,
        "precision": 0.9407407407407408,
        "recall": 0.9806949806949807,
        "f1": 0.9603024574669187
      },
      "val": {
        "accuracy": 0.6266666666666667,
        "precision": 0.43902439024390244,
        "recall": 0.35294117647058826,
        "f1": 0.391304347826087
      },
      "test": {
        "accuracy": 0.56,
        "precision": 0.39655172413793105,
        "recall": 0.42592592592592593,
        "f1": 0.4107142857142857
      }
    },
    {
      "layer": 17,
      "best_C": 0.1,
      "train": {
        "accuracy": 0.9871428571428571,
        "precision": 0.9770992366412213,
        "recall": 0.9884169884169884,
        "f1": 0.982725527831094
      },
      "val": {
        "accuracy": 0.6133333333333333,
        "precision": 0.42857142857142855,
        "recall": 0.4117647058823529,
        "f1": 0.42
      },
      "test": {
        "accuracy": 0.5866666666666667,
        "precision": 0.4166666666666667,
        "recall": 0.37037037037037035,
        "f1": 0.39215686274509803
      }
    },
    {
      "layer": 18,
      "best_C": 0.1,
      "train": {
        "accuracy": 0.9942857142857143,
        "precision": 0.9885057471264368,
        "recall": 0.9961389961389961,
        "f1": 0.9923076923076923
      },
      "val": {
        "accuracy": 0.6,
        "precision": 0.40425531914893614,
        "recall": 0.37254901960784315,
        "f1": 0.3877551020408163
      },
      "test": {
        "accuracy": 0.6066666666666667,
        "precision": 0.45454545454545453,
        "recall": 0.46296296296296297,
        "f1": 0.45871559633027525
      }
    },
    {
      "layer": 19,
      "best_C": 100.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.5933333333333334,
        "precision": 0.3958333333333333,
        "recall": 0.37254901960784315,
        "f1": 0.3838383838383838
      },
      "test": {
        "accuracy": 0.6133333333333333,
        "precision": 0.46153846153846156,
        "recall": 0.4444444444444444,
        "f1": 0.4528301886792453
      }
    },
    {
      "layer": 20,
      "best_C": 1.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.5733333333333334,
        "precision": 0.37735849056603776,
        "recall": 0.39215686274509803,
        "f1": 0.38461538461538464
      },
      "test": {
        "accuracy": 0.64,
        "precision": 0.5,
        "recall": 0.4074074074074074,
        "f1": 0.4489795918367347
      }
    },
    {
      "layer": 21,
      "best_C": 0.1,
      "train": {
        "accuracy": 0.9985714285714286,
        "precision": 0.9961538461538462,
        "recall": 1.0,
        "f1": 0.9980732177263969
      },
      "val": {
        "accuracy": 0.5666666666666667,
        "precision": 0.375,
        "recall": 0.4117647058823529,
        "f1": 0.3925233644859813
      },
      "test": {
        "accuracy": 0.6533333333333333,
        "precision": 0.5217391304347826,
        "recall": 0.4444444444444444,
        "f1": 0.48
      }
    },
    {
      "layer": 22,
      "best_C": 10.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.5466666666666666,
        "precision": 0.34545454545454546,
        "recall": 0.37254901960784315,
        "f1": 0.3584905660377358
      },
      "test": {
        "accuracy": 0.6666666666666666,
        "precision": 0.5476190476190477,
        "recall": 0.42592592592592593,
        "f1": 0.4791666666666667
      }
    },
    {
      "layer": 23,
      "best_C": 1.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.5666666666666667,
        "precision": 0.36538461538461536,
        "recall": 0.37254901960784315,
        "f1": 0.36893203883495146
      },
      "test": {
        "accuracy": 0.6466666666666666,
        "precision": 0.5111111111111111,
        "recall": 0.42592592592592593,
        "f1": 0.46464646464646464
      }
    },
    {
      "layer": 24,
      "best_C": 1.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.56,
        "precision": 0.36363636363636365,
        "recall": 0.39215686274509803,
        "f1": 0.37735849056603776
      },
      "test": {
        "accuracy": 0.6466666666666666,
        "precision": 0.5094339622641509,
        "recall": 0.5,
        "f1": 0.5046728971962616
      }
    },
    {
      "layer": 25,
      "best_C": 0.1,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.56,
        "precision": 0.3684210526315789,
        "recall": 0.4117647058823529,
        "f1": 0.3888888888888889
      },
      "test": {
        "accuracy": 0.6333333333333333,
        "precision": 0.4897959183673469,
        "recall": 0.4444444444444444,
        "f1": 0.46601941747572817
      }
    },
    {
      "layer": 26,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.9985714285714286,
        "precision": 0.9961538461538462,
        "recall": 1.0,
        "f1": 0.9980732177263969
      },
      "val": {
        "accuracy": 0.5866666666666667,
        "precision": 0.39622641509433965,
        "recall": 0.4117647058823529,
        "f1": 0.40384615384615385
      },
      "test": {
        "accuracy": 0.5866666666666667,
        "precision": 0.42,
        "recall": 0.3888888888888889,
        "f1": 0.40384615384615385
      }
    },
    {
      "layer": 27,
      "best_C": 1.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.54,
        "precision": 0.3392857142857143,
        "recall": 0.37254901960784315,
        "f1": 0.35514018691588783
      },
      "test": {
        "accuracy": 0.6,
        "precision": 0.4375,
        "recall": 0.3888888888888889,
        "f1": 0.4117647058823529
      }
    },
    {
      "layer": 28,
      "best_C": 10.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.5666666666666667,
        "precision": 0.36,
        "recall": 0.35294117647058826,
        "f1": 0.3564356435643564
      },
      "test": {
        "accuracy": 0.5933333333333334,
        "precision": 0.4222222222222222,
        "recall": 0.35185185185185186,
        "f1": 0.3838383838383838
      }
    },
    {
      "layer": 29,
      "best_C": 1.0,
      "train": {
        "accuracy": 0.9442857142857143,
        "precision": 0.9044117647058824,
        "recall": 0.9498069498069498,
        "f1": 0.9265536723163842
      },
      "val": {
        "accuracy": 0.5533333333333333,
        "precision": 0.34615384615384615,
        "recall": 0.35294117647058826,
        "f1": 0.34951456310679613
      },
      "test": {
        "accuracy": 0.62,
        "precision": 0.46808510638297873,
        "recall": 0.4074074074074074,
        "f1": 0.43564356435643564
      }
    }
  ]
}