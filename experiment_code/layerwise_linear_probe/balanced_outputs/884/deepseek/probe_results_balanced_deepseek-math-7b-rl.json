{
  "model_name": "deepseek-ai/deepseek-math-7b-rl",
  "n_layers": 30,
  "n_train": 700,
  "n_val": 150,
  "n_test": 150,
  "n_total": 1000,
  "n_correct": 289,
  "n_incorrect": 711,
  "correct_ratio": 28.9,
  "class_weight": "balanced",
  "indices_path": "/Users/antyabharahman/Downloads/Personal/final_research/paper_codebase/-rl-sft-reasoning/experiment_code/layerwise_linear_probe/balanced_outputs/884/deepseek/balanced_indices_deepseek-math-7b-rl.json",
  "probe_config": {
    "cv_folds": 5,
    "C_range": [
      0.01,
      0.1,
      1.0,
      10.0,
      100.0
    ],
    "max_iter": 5000,
    "random_state": 42,
    "solver": "lbfgs"
  },
  "layer_results": [
    {
      "layer": 0,
      "best_C": 100.0,
      "train": {
        "accuracy": 0.9428571428571428,
        "precision": 0.8429752066115702,
        "recall": 0.9902912621359223,
        "f1": 0.9107142857142857
      },
      "val": {
        "accuracy": 0.7066666666666667,
        "precision": 0.4909090909090909,
        "recall": 0.627906976744186,
        "f1": 0.5510204081632653
      },
      "test": {
        "accuracy": 0.7333333333333333,
        "precision": 0.5,
        "recall": 0.775,
        "f1": 0.6078431372549019
      }
    },
    {
      "layer": 1,
      "best_C": 10.0,
      "train": {
        "accuracy": 0.9242857142857143,
        "precision": 0.8,
        "recall": 0.9902912621359223,
        "f1": 0.8850325379609545
      },
      "val": {
        "accuracy": 0.6933333333333334,
        "precision": 0.47368421052631576,
        "recall": 0.627906976744186,
        "f1": 0.54
      },
      "test": {
        "accuracy": 0.74,
        "precision": 0.5079365079365079,
        "recall": 0.8,
        "f1": 0.6213592233009708
      }
    },
    {
      "layer": 2,
      "best_C": 10.0,
      "train": {
        "accuracy": 0.9628571428571429,
        "precision": 0.8879310344827587,
        "recall": 1.0,
        "f1": 0.9406392694063926
      },
      "val": {
        "accuracy": 0.7333333333333333,
        "precision": 0.5283018867924528,
        "recall": 0.6511627906976745,
        "f1": 0.5833333333333334
      },
      "test": {
        "accuracy": 0.72,
        "precision": 0.48148148148148145,
        "recall": 0.65,
        "f1": 0.5531914893617021
      }
    },
    {
      "layer": 3,
      "best_C": 10.0,
      "train": {
        "accuracy": 0.9871428571428571,
        "precision": 0.958139534883721,
        "recall": 1.0,
        "f1": 0.9786223277909739
      },
      "val": {
        "accuracy": 0.74,
        "precision": 0.5384615384615384,
        "recall": 0.6511627906976745,
        "f1": 0.5894736842105263
      },
      "test": {
        "accuracy": 0.7,
        "precision": 0.4444444444444444,
        "recall": 0.5,
        "f1": 0.47058823529411764
      }
    },
    {
      "layer": 4,
      "best_C": 10.0,
      "train": {
        "accuracy": 0.9985714285714286,
        "precision": 0.9951690821256038,
        "recall": 1.0,
        "f1": 0.9975786924939467
      },
      "val": {
        "accuracy": 0.7466666666666667,
        "precision": 0.5471698113207547,
        "recall": 0.6744186046511628,
        "f1": 0.6041666666666666
      },
      "test": {
        "accuracy": 0.74,
        "precision": 0.5111111111111111,
        "recall": 0.575,
        "f1": 0.5411764705882353
      }
    },
    {
      "layer": 5,
      "best_C": 1.0,
      "train": {
        "accuracy": 0.97,
        "precision": 0.9074889867841409,
        "recall": 1.0,
        "f1": 0.9515011547344111
      },
      "val": {
        "accuracy": 0.7333333333333333,
        "precision": 0.5263157894736842,
        "recall": 0.6976744186046512,
        "f1": 0.6
      },
      "test": {
        "accuracy": 0.7066666666666667,
        "precision": 0.46153846153846156,
        "recall": 0.6,
        "f1": 0.5217391304347826
      }
    },
    {
      "layer": 6,
      "best_C": 1.0,
      "train": {
        "accuracy": 0.9885714285714285,
        "precision": 0.9626168224299065,
        "recall": 1.0,
        "f1": 0.9809523809523809
      },
      "val": {
        "accuracy": 0.7333333333333333,
        "precision": 0.5254237288135594,
        "recall": 0.7209302325581395,
        "f1": 0.6078431372549019
      },
      "test": {
        "accuracy": 0.6933333333333334,
        "precision": 0.44642857142857145,
        "recall": 0.625,
        "f1": 0.5208333333333334
      }
    },
    {
      "layer": 7,
      "best_C": 1.0,
      "train": {
        "accuracy": 0.9928571428571429,
        "precision": 0.976303317535545,
        "recall": 1.0,
        "f1": 0.988009592326139
      },
      "val": {
        "accuracy": 0.6933333333333334,
        "precision": 0.47619047619047616,
        "recall": 0.6976744186046512,
        "f1": 0.5660377358490566
      },
      "test": {
        "accuracy": 0.7133333333333334,
        "precision": 0.4745762711864407,
        "recall": 0.7,
        "f1": 0.5656565656565656
      }
    },
    {
      "layer": 8,
      "best_C": 0.1,
      "train": {
        "accuracy": 0.9528571428571428,
        "precision": 0.8619246861924686,
        "recall": 1.0,
        "f1": 0.9258426966292135
      },
      "val": {
        "accuracy": 0.7066666666666667,
        "precision": 0.4918032786885246,
        "recall": 0.6976744186046512,
        "f1": 0.5769230769230769
      },
      "test": {
        "accuracy": 0.72,
        "precision": 0.48333333333333334,
        "recall": 0.725,
        "f1": 0.58
      }
    },
    {
      "layer": 9,
      "best_C": 0.1,
      "train": {
        "accuracy": 0.9657142857142857,
        "precision": 0.8956521739130435,
        "recall": 1.0,
        "f1": 0.944954128440367
      },
      "val": {
        "accuracy": 0.72,
        "precision": 0.5084745762711864,
        "recall": 0.6976744186046512,
        "f1": 0.5882352941176471
      },
      "test": {
        "accuracy": 0.7266666666666667,
        "precision": 0.49122807017543857,
        "recall": 0.7,
        "f1": 0.5773195876288659
      }
    },
    {
      "layer": 10,
      "best_C": 0.1,
      "train": {
        "accuracy": 0.9728571428571429,
        "precision": 0.9155555555555556,
        "recall": 1.0,
        "f1": 0.9559164733178654
      },
      "val": {
        "accuracy": 0.74,
        "precision": 0.53125,
        "recall": 0.7906976744186046,
        "f1": 0.6355140186915887
      },
      "test": {
        "accuracy": 0.7533333333333333,
        "precision": 0.5263157894736842,
        "recall": 0.75,
        "f1": 0.6185567010309279
      }
    },
    {
      "layer": 11,
      "best_C": 0.1,
      "train": {
        "accuracy": 0.9828571428571429,
        "precision": 0.944954128440367,
        "recall": 1.0,
        "f1": 0.9716981132075472
      },
      "val": {
        "accuracy": 0.7866666666666666,
        "precision": 0.5932203389830508,
        "recall": 0.813953488372093,
        "f1": 0.6862745098039216
      },
      "test": {
        "accuracy": 0.74,
        "precision": 0.5094339622641509,
        "recall": 0.675,
        "f1": 0.5806451612903226
      }
    },
    {
      "layer": 12,
      "best_C": 0.1,
      "train": {
        "accuracy": 0.99,
        "precision": 0.9671361502347418,
        "recall": 1.0,
        "f1": 0.9832935560859188
      },
      "val": {
        "accuracy": 0.74,
        "precision": 0.5370370370370371,
        "recall": 0.6744186046511628,
        "f1": 0.5979381443298969
      },
      "test": {
        "accuracy": 0.74,
        "precision": 0.5087719298245614,
        "recall": 0.725,
        "f1": 0.5979381443298969
      }
    },
    {
      "layer": 13,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.94,
        "precision": 0.8333333333333334,
        "recall": 0.9951456310679612,
        "f1": 0.9070796460176991
      },
      "val": {
        "accuracy": 0.74,
        "precision": 0.53125,
        "recall": 0.7906976744186046,
        "f1": 0.6355140186915887
      },
      "test": {
        "accuracy": 0.7733333333333333,
        "precision": 0.5483870967741935,
        "recall": 0.85,
        "f1": 0.6666666666666666
      }
    },
    {
      "layer": 14,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.94,
        "precision": 0.8360655737704918,
        "recall": 0.9902912621359223,
        "f1": 0.9066666666666666
      },
      "val": {
        "accuracy": 0.7333333333333333,
        "precision": 0.5230769230769231,
        "recall": 0.7906976744186046,
        "f1": 0.6296296296296297
      },
      "test": {
        "accuracy": 0.7733333333333333,
        "precision": 0.5483870967741935,
        "recall": 0.85,
        "f1": 0.6666666666666666
      }
    },
    {
      "layer": 15,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.9471428571428572,
        "precision": 0.8506224066390041,
        "recall": 0.9951456310679612,
        "f1": 0.9172259507829977
      },
      "val": {
        "accuracy": 0.74,
        "precision": 0.53125,
        "recall": 0.7906976744186046,
        "f1": 0.6355140186915887
      },
      "test": {
        "accuracy": 0.7666666666666667,
        "precision": 0.5396825396825397,
        "recall": 0.85,
        "f1": 0.6601941747572816
      }
    },
    {
      "layer": 16,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.9485714285714286,
        "precision": 0.8541666666666666,
        "recall": 0.9951456310679612,
        "f1": 0.9192825112107623
      },
      "val": {
        "accuracy": 0.7533333333333333,
        "precision": 0.55,
        "recall": 0.7674418604651163,
        "f1": 0.6407766990291263
      },
      "test": {
        "accuracy": 0.7666666666666667,
        "precision": 0.5396825396825397,
        "recall": 0.85,
        "f1": 0.6601941747572816
      }
    },
    {
      "layer": 17,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.96,
        "precision": 0.8836206896551724,
        "recall": 0.9951456310679612,
        "f1": 0.9360730593607306
      },
      "val": {
        "accuracy": 0.7733333333333333,
        "precision": 0.5714285714285714,
        "recall": 0.8372093023255814,
        "f1": 0.6792452830188679
      },
      "test": {
        "accuracy": 0.78,
        "precision": 0.5573770491803278,
        "recall": 0.85,
        "f1": 0.6732673267326733
      }
    },
    {
      "layer": 18,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.9657142857142857,
        "precision": 0.8991228070175439,
        "recall": 0.9951456310679612,
        "f1": 0.9447004608294931
      },
      "val": {
        "accuracy": 0.74,
        "precision": 0.5333333333333333,
        "recall": 0.7441860465116279,
        "f1": 0.6213592233009708
      },
      "test": {
        "accuracy": 0.78,
        "precision": 0.5555555555555556,
        "recall": 0.875,
        "f1": 0.6796116504854369
      }
    },
    {
      "layer": 19,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.9714285714285714,
        "precision": 0.911504424778761,
        "recall": 1.0,
        "f1": 0.9537037037037037
      },
      "val": {
        "accuracy": 0.7466666666666667,
        "precision": 0.5423728813559322,
        "recall": 0.7441860465116279,
        "f1": 0.6274509803921569
      },
      "test": {
        "accuracy": 0.7466666666666667,
        "precision": 0.5172413793103449,
        "recall": 0.75,
        "f1": 0.6122448979591837
      }
    },
    {
      "layer": 20,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.9771428571428571,
        "precision": 0.9279279279279279,
        "recall": 1.0,
        "f1": 0.9626168224299065
      },
      "val": {
        "accuracy": 0.7533333333333333,
        "precision": 0.5517241379310345,
        "recall": 0.7441860465116279,
        "f1": 0.6336633663366337
      },
      "test": {
        "accuracy": 0.7533333333333333,
        "precision": 0.5263157894736842,
        "recall": 0.75,
        "f1": 0.6185567010309279
      }
    },
    {
      "layer": 21,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.9814285714285714,
        "precision": 0.9406392694063926,
        "recall": 1.0,
        "f1": 0.9694117647058823
      },
      "val": {
        "accuracy": 0.7666666666666667,
        "precision": 0.5689655172413793,
        "recall": 0.7674418604651163,
        "f1": 0.6534653465346535
      },
      "test": {
        "accuracy": 0.7666666666666667,
        "precision": 0.5454545454545454,
        "recall": 0.75,
        "f1": 0.631578947368421
      }
    },
    {
      "layer": 22,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.9885714285714285,
        "precision": 0.9626168224299065,
        "recall": 1.0,
        "f1": 0.9809523809523809
      },
      "val": {
        "accuracy": 0.76,
        "precision": 0.5636363636363636,
        "recall": 0.7209302325581395,
        "f1": 0.6326530612244898
      },
      "test": {
        "accuracy": 0.7933333333333333,
        "precision": 0.5882352941176471,
        "recall": 0.75,
        "f1": 0.6593406593406593
      }
    },
    {
      "layer": 23,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.9942857142857143,
        "precision": 0.9809523809523809,
        "recall": 1.0,
        "f1": 0.9903846153846154
      },
      "val": {
        "accuracy": 0.7733333333333333,
        "precision": 0.5849056603773585,
        "recall": 0.7209302325581395,
        "f1": 0.6458333333333334
      },
      "test": {
        "accuracy": 0.7733333333333333,
        "precision": 0.5576923076923077,
        "recall": 0.725,
        "f1": 0.6304347826086957
      }
    },
    {
      "layer": 24,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.9971428571428571,
        "precision": 0.9903846153846154,
        "recall": 1.0,
        "f1": 0.9951690821256038
      },
      "val": {
        "accuracy": 0.7533333333333333,
        "precision": 0.5625,
        "recall": 0.627906976744186,
        "f1": 0.5934065934065934
      },
      "test": {
        "accuracy": 0.7733333333333333,
        "precision": 0.5576923076923077,
        "recall": 0.725,
        "f1": 0.6304347826086957
      }
    },
    {
      "layer": 25,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.9971428571428571,
        "precision": 0.9903846153846154,
        "recall": 1.0,
        "f1": 0.9951690821256038
      },
      "val": {
        "accuracy": 0.7666666666666667,
        "precision": 0.5769230769230769,
        "recall": 0.6976744186046512,
        "f1": 0.631578947368421
      },
      "test": {
        "accuracy": 0.76,
        "precision": 0.5370370370370371,
        "recall": 0.725,
        "f1": 0.6170212765957447
      }
    },
    {
      "layer": 26,
      "best_C": 0.01,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.7333333333333333,
        "precision": 0.5294117647058824,
        "recall": 0.627906976744186,
        "f1": 0.574468085106383
      },
      "test": {
        "accuracy": 0.74,
        "precision": 0.5098039215686274,
        "recall": 0.65,
        "f1": 0.5714285714285714
      }
    },
    {
      "layer": 27,
      "best_C": 0.01,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.7533333333333333,
        "precision": 0.5576923076923077,
        "recall": 0.6744186046511628,
        "f1": 0.6105263157894737
      },
      "test": {
        "accuracy": 0.7266666666666667,
        "precision": 0.49056603773584906,
        "recall": 0.65,
        "f1": 0.5591397849462365
      }
    },
    {
      "layer": 28,
      "best_C": 0.01,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.7466666666666667,
        "precision": 0.5510204081632653,
        "recall": 0.627906976744186,
        "f1": 0.5869565217391305
      },
      "test": {
        "accuracy": 0.7333333333333333,
        "precision": 0.5,
        "recall": 0.65,
        "f1": 0.5652173913043478
      }
    },
    {
      "layer": 29,
      "best_C": 1.0,
      "train": {
        "accuracy": 0.9557142857142857,
        "precision": 0.869198312236287,
        "recall": 1.0,
        "f1": 0.9300225733634312
      },
      "val": {
        "accuracy": 0.7266666666666667,
        "precision": 0.5178571428571429,
        "recall": 0.6744186046511628,
        "f1": 0.5858585858585859
      },
      "test": {
        "accuracy": 0.76,
        "precision": 0.5357142857142857,
        "recall": 0.75,
        "f1": 0.625
      }
    }
  ]
}