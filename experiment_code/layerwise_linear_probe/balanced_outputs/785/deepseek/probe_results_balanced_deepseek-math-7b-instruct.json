{
  "model_name": "deepseek-ai/deepseek-math-7b-instruct",
  "n_layers": 30,
  "n_train": 700,
  "n_val": 150,
  "n_test": 150,
  "n_total": 1000,
  "n_correct": 844,
  "n_incorrect": 156,
  "correct_ratio": 84.4,
  "class_weight": "balanced",
  "indices_path": "/Users/antyabharahman/Downloads/Personal/final_research/paper_codebase/-rl-sft-reasoning/experiment_code/layerwise_linear_probe/balanced_outputs/785/deepseek/balanced_indices_deepseek-math-7b-instruct.json",
  "probe_config": {
    "cv_folds": 5,
    "C_range": [
      0.01,
      0.1,
      1.0,
      10.0,
      100.0
    ],
    "max_iter": 5000,
    "random_state": 42,
    "solver": "lbfgs"
  },
  "layer_results": [
    {
      "layer": 0,
      "best_C": 100.0,
      "train": {
        "accuracy": 0.9485714285714286,
        "precision": 0.9744897959183674,
        "recall": 0.9646464646464646,
        "f1": 0.9695431472081218
      },
      "val": {
        "accuracy": 0.9,
        "precision": 0.9375,
        "recall": 0.9448818897637795,
        "f1": 0.9411764705882353
      },
      "test": {
        "accuracy": 0.9333333333333333,
        "precision": 0.9829059829059829,
        "recall": 0.9349593495934959,
        "f1": 0.9583333333333334
      }
    },
    {
      "layer": 1,
      "best_C": 10.0,
      "train": {
        "accuracy": 0.96,
        "precision": 0.9748322147651006,
        "recall": 0.9781144781144782,
        "f1": 0.9764705882352941
      },
      "val": {
        "accuracy": 0.9066666666666666,
        "precision": 0.937984496124031,
        "recall": 0.952755905511811,
        "f1": 0.9453125
      },
      "test": {
        "accuracy": 0.94,
        "precision": 0.9913793103448276,
        "recall": 0.9349593495934959,
        "f1": 0.9623430962343096
      }
    },
    {
      "layer": 2,
      "best_C": 10.0,
      "train": {
        "accuracy": 0.9628571428571429,
        "precision": 0.9781144781144782,
        "recall": 0.9781144781144782,
        "f1": 0.9781144781144782
      },
      "val": {
        "accuracy": 0.9066666666666666,
        "precision": 0.937984496124031,
        "recall": 0.952755905511811,
        "f1": 0.9453125
      },
      "test": {
        "accuracy": 0.9333333333333333,
        "precision": 0.991304347826087,
        "recall": 0.926829268292683,
        "f1": 0.957983193277311
      }
    },
    {
      "layer": 3,
      "best_C": 10.0,
      "train": {
        "accuracy": 0.9685714285714285,
        "precision": 0.9814814814814815,
        "recall": 0.9814814814814815,
        "f1": 0.9814814814814815
      },
      "val": {
        "accuracy": 0.8933333333333333,
        "precision": 0.937007874015748,
        "recall": 0.937007874015748,
        "f1": 0.937007874015748
      },
      "test": {
        "accuracy": 0.9466666666666667,
        "precision": 0.9914529914529915,
        "recall": 0.943089430894309,
        "f1": 0.9666666666666667
      }
    },
    {
      "layer": 4,
      "best_C": 1.0,
      "train": {
        "accuracy": 0.9542857142857143,
        "precision": 0.976271186440678,
        "recall": 0.9696969696969697,
        "f1": 0.972972972972973
      },
      "val": {
        "accuracy": 0.8933333333333333,
        "precision": 0.937007874015748,
        "recall": 0.937007874015748,
        "f1": 0.937007874015748
      },
      "test": {
        "accuracy": 0.9266666666666666,
        "precision": 0.9912280701754386,
        "recall": 0.9186991869918699,
        "f1": 0.9535864978902954
      }
    },
    {
      "layer": 5,
      "best_C": 1.0,
      "train": {
        "accuracy": 0.9614285714285714,
        "precision": 0.9780775716694773,
        "recall": 0.9764309764309764,
        "f1": 0.9772535804549284
      },
      "val": {
        "accuracy": 0.92,
        "precision": 0.9457364341085271,
        "recall": 0.9606299212598425,
        "f1": 0.953125
      },
      "test": {
        "accuracy": 0.9333333333333333,
        "precision": 0.991304347826087,
        "recall": 0.926829268292683,
        "f1": 0.957983193277311
      }
    },
    {
      "layer": 6,
      "best_C": 1.0,
      "train": {
        "accuracy": 0.97,
        "precision": 0.9798994974874372,
        "recall": 0.9848484848484849,
        "f1": 0.982367758186398
      },
      "val": {
        "accuracy": 0.9266666666666666,
        "precision": 0.9461538461538461,
        "recall": 0.968503937007874,
        "f1": 0.9571984435797666
      },
      "test": {
        "accuracy": 0.94,
        "precision": 0.9913793103448276,
        "recall": 0.9349593495934959,
        "f1": 0.9623430962343096
      }
    },
    {
      "layer": 7,
      "best_C": 10.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.92,
        "precision": 0.9389312977099237,
        "recall": 0.968503937007874,
        "f1": 0.9534883720930233
      },
      "test": {
        "accuracy": 0.9333333333333333,
        "precision": 0.9829059829059829,
        "recall": 0.9349593495934959,
        "f1": 0.9583333333333334
      }
    },
    {
      "layer": 8,
      "best_C": 1.0,
      "train": {
        "accuracy": 0.9842857142857143,
        "precision": 0.9882747068676717,
        "recall": 0.9932659932659933,
        "f1": 0.9907640638119227
      },
      "val": {
        "accuracy": 0.9333333333333333,
        "precision": 0.9465648854961832,
        "recall": 0.9763779527559056,
        "f1": 0.9612403100775194
      },
      "test": {
        "accuracy": 0.9533333333333334,
        "precision": 0.9915254237288136,
        "recall": 0.9512195121951219,
        "f1": 0.970954356846473
      }
    },
    {
      "layer": 9,
      "best_C": 100.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.9466666666666667,
        "precision": 0.9473684210526315,
        "recall": 0.9921259842519685,
        "f1": 0.9692307692307692
      },
      "test": {
        "accuracy": 0.96,
        "precision": 0.9915966386554622,
        "recall": 0.959349593495935,
        "f1": 0.9752066115702479
      }
    },
    {
      "layer": 10,
      "best_C": 0.1,
      "train": {
        "accuracy": 0.9671428571428572,
        "precision": 0.9798319327731092,
        "recall": 0.9814814814814815,
        "f1": 0.9806560134566863
      },
      "val": {
        "accuracy": 0.9266666666666666,
        "precision": 0.9461538461538461,
        "recall": 0.968503937007874,
        "f1": 0.9571984435797666
      },
      "test": {
        "accuracy": 0.9466666666666667,
        "precision": 0.9914529914529915,
        "recall": 0.943089430894309,
        "f1": 0.9666666666666667
      }
    },
    {
      "layer": 11,
      "best_C": 0.1,
      "train": {
        "accuracy": 0.9785714285714285,
        "precision": 0.9816971713810316,
        "recall": 0.9932659932659933,
        "f1": 0.9874476987447699
      },
      "val": {
        "accuracy": 0.9333333333333333,
        "precision": 0.9465648854961832,
        "recall": 0.9763779527559056,
        "f1": 0.9612403100775194
      },
      "test": {
        "accuracy": 0.9666666666666667,
        "precision": 0.9916666666666667,
        "recall": 0.967479674796748,
        "f1": 0.9794238683127572
      }
    },
    {
      "layer": 12,
      "best_C": 0.1,
      "train": {
        "accuracy": 0.9871428571428571,
        "precision": 0.9866888519134775,
        "recall": 0.9983164983164983,
        "f1": 0.9924686192468619
      },
      "val": {
        "accuracy": 0.94,
        "precision": 0.9538461538461539,
        "recall": 0.9763779527559056,
        "f1": 0.9649805447470817
      },
      "test": {
        "accuracy": 0.9666666666666667,
        "precision": 0.9916666666666667,
        "recall": 0.967479674796748,
        "f1": 0.9794238683127572
      }
    },
    {
      "layer": 13,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.9671428571428572,
        "precision": 0.9766277128547579,
        "recall": 0.9848484848484849,
        "f1": 0.980720871751886
      },
      "val": {
        "accuracy": 0.94,
        "precision": 0.946969696969697,
        "recall": 0.984251968503937,
        "f1": 0.9652509652509652
      },
      "test": {
        "accuracy": 0.9533333333333334,
        "precision": 0.9915254237288136,
        "recall": 0.9512195121951219,
        "f1": 0.970954356846473
      }
    },
    {
      "layer": 14,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.9742857142857143,
        "precision": 0.98,
        "recall": 0.98989898989899,
        "f1": 0.9849246231155779
      },
      "val": {
        "accuracy": 0.9266666666666666,
        "precision": 0.9461538461538461,
        "recall": 0.968503937007874,
        "f1": 0.9571984435797666
      },
      "test": {
        "accuracy": 0.9666666666666667,
        "precision": 0.9916666666666667,
        "recall": 0.967479674796748,
        "f1": 0.9794238683127572
      }
    },
    {
      "layer": 15,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.9771428571428571,
        "precision": 0.9816666666666667,
        "recall": 0.9915824915824916,
        "f1": 0.9865996649916248
      },
      "val": {
        "accuracy": 0.9133333333333333,
        "precision": 0.9384615384615385,
        "recall": 0.9606299212598425,
        "f1": 0.9494163424124513
      },
      "test": {
        "accuracy": 0.96,
        "precision": 0.9915966386554622,
        "recall": 0.959349593495935,
        "f1": 0.9752066115702479
      }
    },
    {
      "layer": 16,
      "best_C": 0.1,
      "train": {
        "accuracy": 0.9971428571428571,
        "precision": 0.9966442953020134,
        "recall": 1.0,
        "f1": 0.9983193277310924
      },
      "val": {
        "accuracy": 0.92,
        "precision": 0.9389312977099237,
        "recall": 0.968503937007874,
        "f1": 0.9534883720930233
      },
      "test": {
        "accuracy": 0.96,
        "precision": 0.9915966386554622,
        "recall": 0.959349593495935,
        "f1": 0.9752066115702479
      }
    },
    {
      "layer": 17,
      "best_C": 0.1,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.9266666666666666,
        "precision": 0.9393939393939394,
        "recall": 0.9763779527559056,
        "f1": 0.9575289575289575
      },
      "test": {
        "accuracy": 0.96,
        "precision": 0.9915966386554622,
        "recall": 0.959349593495935,
        "f1": 0.9752066115702479
      }
    },
    {
      "layer": 18,
      "best_C": 0.1,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.94,
        "precision": 0.9402985074626866,
        "recall": 0.9921259842519685,
        "f1": 0.9655172413793104
      },
      "test": {
        "accuracy": 0.9666666666666667,
        "precision": 0.9916666666666667,
        "recall": 0.967479674796748,
        "f1": 0.9794238683127572
      }
    },
    {
      "layer": 19,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.9942857142857143,
        "precision": 0.9949664429530202,
        "recall": 0.9983164983164983,
        "f1": 0.9966386554621849
      },
      "val": {
        "accuracy": 0.94,
        "precision": 0.946969696969697,
        "recall": 0.984251968503937,
        "f1": 0.9652509652509652
      },
      "test": {
        "accuracy": 0.96,
        "precision": 0.975609756097561,
        "recall": 0.975609756097561,
        "f1": 0.975609756097561
      }
    },
    {
      "layer": 20,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.9971428571428571,
        "precision": 0.9983164983164983,
        "recall": 0.9983164983164983,
        "f1": 0.9983164983164983
      },
      "val": {
        "accuracy": 0.9333333333333333,
        "precision": 0.9465648854961832,
        "recall": 0.9763779527559056,
        "f1": 0.9612403100775194
      },
      "test": {
        "accuracy": 0.9733333333333334,
        "precision": 0.9917355371900827,
        "recall": 0.975609756097561,
        "f1": 0.9836065573770492
      }
    },
    {
      "layer": 21,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.9985714285714286,
        "precision": 1.0,
        "recall": 0.9983164983164983,
        "f1": 0.9991575400168492
      },
      "val": {
        "accuracy": 0.9333333333333333,
        "precision": 0.9465648854961832,
        "recall": 0.9763779527559056,
        "f1": 0.9612403100775194
      },
      "test": {
        "accuracy": 0.96,
        "precision": 0.9834710743801653,
        "recall": 0.967479674796748,
        "f1": 0.9754098360655737
      }
    },
    {
      "layer": 22,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.9985714285714286,
        "precision": 1.0,
        "recall": 0.9983164983164983,
        "f1": 0.9991575400168492
      },
      "val": {
        "accuracy": 0.9333333333333333,
        "precision": 0.9465648854961832,
        "recall": 0.9763779527559056,
        "f1": 0.9612403100775194
      },
      "test": {
        "accuracy": 0.9533333333333334,
        "precision": 0.9754098360655737,
        "recall": 0.967479674796748,
        "f1": 0.9714285714285714
      }
    },
    {
      "layer": 23,
      "best_C": 0.01,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.9266666666666666,
        "precision": 0.9393939393939394,
        "recall": 0.9763779527559056,
        "f1": 0.9575289575289575
      },
      "test": {
        "accuracy": 0.94,
        "precision": 0.975,
        "recall": 0.9512195121951219,
        "f1": 0.9629629629629629
      }
    },
    {
      "layer": 24,
      "best_C": 0.01,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.9266666666666666,
        "precision": 0.9393939393939394,
        "recall": 0.9763779527559056,
        "f1": 0.9575289575289575
      },
      "test": {
        "accuracy": 0.9333333333333333,
        "precision": 0.9747899159663865,
        "recall": 0.943089430894309,
        "f1": 0.9586776859504132
      }
    },
    {
      "layer": 25,
      "best_C": 100.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.9266666666666666,
        "precision": 0.9393939393939394,
        "recall": 0.9763779527559056,
        "f1": 0.9575289575289575
      },
      "test": {
        "accuracy": 0.9133333333333333,
        "precision": 0.9661016949152542,
        "recall": 0.926829268292683,
        "f1": 0.946058091286307
      }
    },
    {
      "layer": 26,
      "best_C": 1.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.9266666666666666,
        "precision": 0.9393939393939394,
        "recall": 0.9763779527559056,
        "f1": 0.9575289575289575
      },
      "test": {
        "accuracy": 0.92,
        "precision": 0.9743589743589743,
        "recall": 0.926829268292683,
        "f1": 0.95
      }
    },
    {
      "layer": 27,
      "best_C": 0.1,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.92,
        "precision": 0.9323308270676691,
        "recall": 0.9763779527559056,
        "f1": 0.9538461538461539
      },
      "test": {
        "accuracy": 0.94,
        "precision": 0.975,
        "recall": 0.9512195121951219,
        "f1": 0.9629629629629629
      }
    },
    {
      "layer": 28,
      "best_C": 0.1,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.92,
        "precision": 0.9323308270676691,
        "recall": 0.9763779527559056,
        "f1": 0.9538461538461539
      },
      "test": {
        "accuracy": 0.9466666666666667,
        "precision": 0.9752066115702479,
        "recall": 0.959349593495935,
        "f1": 0.9672131147540983
      }
    },
    {
      "layer": 29,
      "best_C": 10.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.9266666666666666,
        "precision": 0.9393939393939394,
        "recall": 0.9763779527559056,
        "f1": 0.9575289575289575
      },
      "test": {
        "accuracy": 0.9466666666666667,
        "precision": 0.9752066115702479,
        "recall": 0.959349593495935,
        "f1": 0.9672131147540983
      }
    }
  ]
}