{
  "model_name": "deepseek-ai/deepseek-math-7b-rl",
  "n_layers": 30,
  "n_train": 700,
  "n_val": 150,
  "n_test": 150,
  "n_total": 1000,
  "n_correct": 839,
  "n_incorrect": 161,
  "correct_ratio": 83.9,
  "class_weight": "balanced",
  "indices_path": "/Users/antyabharahman/Downloads/Personal/final_research/paper_codebase/-rl-sft-reasoning/experiment_code/layerwise_linear_probe/balanced_outputs/785/deepseek/balanced_indices_deepseek-math-7b-rl.json",
  "probe_config": {
    "cv_folds": 5,
    "C_range": [
      0.01,
      0.1,
      1.0,
      10.0,
      100.0
    ],
    "max_iter": 5000,
    "random_state": 42,
    "solver": "lbfgs"
  },
  "layer_results": [
    {
      "layer": 0,
      "best_C": 10.0,
      "train": {
        "accuracy": 0.9928571428571429,
        "precision": 0.9932318104906938,
        "recall": 0.9982993197278912,
        "f1": 0.9957591178965225
      },
      "val": {
        "accuracy": 0.9733333333333334,
        "precision": 0.984375,
        "recall": 0.984375,
        "f1": 0.984375
      },
      "test": {
        "accuracy": 0.9733333333333334,
        "precision": 0.968503937007874,
        "recall": 1.0,
        "f1": 0.984
      }
    },
    {
      "layer": 1,
      "best_C": 1.0,
      "train": {
        "accuracy": 0.9928571428571429,
        "precision": 0.9932318104906938,
        "recall": 0.9982993197278912,
        "f1": 0.9957591178965225
      },
      "val": {
        "accuracy": 0.98,
        "precision": 0.9844961240310077,
        "recall": 0.9921875,
        "f1": 0.9883268482490273
      },
      "test": {
        "accuracy": 0.9466666666666667,
        "precision": 0.9457364341085271,
        "recall": 0.991869918699187,
        "f1": 0.9682539682539683
      }
    },
    {
      "layer": 2,
      "best_C": 1.0,
      "train": {
        "accuracy": 0.9928571428571429,
        "precision": 0.9932318104906938,
        "recall": 0.9982993197278912,
        "f1": 0.9957591178965225
      },
      "val": {
        "accuracy": 0.9666666666666667,
        "precision": 0.9767441860465116,
        "recall": 0.984375,
        "f1": 0.980544747081712
      },
      "test": {
        "accuracy": 0.9533333333333334,
        "precision": 0.953125,
        "recall": 0.991869918699187,
        "f1": 0.9721115537848606
      }
    },
    {
      "layer": 3,
      "best_C": 1.0,
      "train": {
        "accuracy": 0.9957142857142857,
        "precision": 0.9966044142614601,
        "recall": 0.9982993197278912,
        "f1": 0.9974511469838573
      },
      "val": {
        "accuracy": 0.9666666666666667,
        "precision": 0.9694656488549618,
        "recall": 0.9921875,
        "f1": 0.9806949806949807
      },
      "test": {
        "accuracy": 0.94,
        "precision": 0.9453125,
        "recall": 0.983739837398374,
        "f1": 0.9641434262948207
      }
    },
    {
      "layer": 4,
      "best_C": 10.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.9866666666666667,
        "precision": 0.9846153846153847,
        "recall": 1.0,
        "f1": 0.9922480620155039
      },
      "test": {
        "accuracy": 0.9533333333333334,
        "precision": 0.9603174603174603,
        "recall": 0.983739837398374,
        "f1": 0.9718875502008032
      }
    },
    {
      "layer": 5,
      "best_C": 10.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.98,
        "precision": 0.9844961240310077,
        "recall": 0.9921875,
        "f1": 0.9883268482490273
      },
      "test": {
        "accuracy": 0.9466666666666667,
        "precision": 0.96,
        "recall": 0.975609756097561,
        "f1": 0.967741935483871
      }
    },
    {
      "layer": 6,
      "best_C": 1.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.9666666666666667,
        "precision": 0.9694656488549618,
        "recall": 0.9921875,
        "f1": 0.9806949806949807
      },
      "test": {
        "accuracy": 0.9466666666666667,
        "precision": 0.96,
        "recall": 0.975609756097561,
        "f1": 0.967741935483871
      }
    },
    {
      "layer": 7,
      "best_C": 100.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.9666666666666667,
        "precision": 0.9694656488549618,
        "recall": 0.9921875,
        "f1": 0.9806949806949807
      },
      "test": {
        "accuracy": 0.9733333333333334,
        "precision": 0.976,
        "recall": 0.991869918699187,
        "f1": 0.9838709677419355
      }
    },
    {
      "layer": 8,
      "best_C": 0.1,
      "train": {
        "accuracy": 0.9985714285714286,
        "precision": 0.99830220713073,
        "recall": 1.0,
        "f1": 0.9991503823279524
      },
      "val": {
        "accuracy": 0.9666666666666667,
        "precision": 0.9694656488549618,
        "recall": 0.9921875,
        "f1": 0.9806949806949807
      },
      "test": {
        "accuracy": 0.9666666666666667,
        "precision": 0.9682539682539683,
        "recall": 0.991869918699187,
        "f1": 0.9799196787148594
      }
    },
    {
      "layer": 9,
      "best_C": 0.1,
      "train": {
        "accuracy": 0.9985714285714286,
        "precision": 0.99830220713073,
        "recall": 1.0,
        "f1": 0.9991503823279524
      },
      "val": {
        "accuracy": 0.98,
        "precision": 0.9770992366412213,
        "recall": 1.0,
        "f1": 0.9884169884169884
      },
      "test": {
        "accuracy": 0.9666666666666667,
        "precision": 0.9682539682539683,
        "recall": 0.991869918699187,
        "f1": 0.9799196787148594
      }
    },
    {
      "layer": 10,
      "best_C": 0.1,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.98,
        "precision": 0.9770992366412213,
        "recall": 1.0,
        "f1": 0.9884169884169884
      },
      "test": {
        "accuracy": 0.9733333333333334,
        "precision": 0.976,
        "recall": 0.991869918699187,
        "f1": 0.9838709677419355
      }
    },
    {
      "layer": 11,
      "best_C": 0.1,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.98,
        "precision": 0.9770992366412213,
        "recall": 1.0,
        "f1": 0.9884169884169884
      },
      "test": {
        "accuracy": 0.98,
        "precision": 0.9761904761904762,
        "recall": 1.0,
        "f1": 0.9879518072289156
      }
    },
    {
      "layer": 12,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.9942857142857143,
        "precision": 0.9932432432432432,
        "recall": 1.0,
        "f1": 0.9966101694915255
      },
      "val": {
        "accuracy": 0.9866666666666667,
        "precision": 0.9846153846153847,
        "recall": 1.0,
        "f1": 0.9922480620155039
      },
      "test": {
        "accuracy": 0.98,
        "precision": 0.9761904761904762,
        "recall": 1.0,
        "f1": 0.9879518072289156
      }
    },
    {
      "layer": 13,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.9942857142857143,
        "precision": 0.9932432432432432,
        "recall": 1.0,
        "f1": 0.9966101694915255
      },
      "val": {
        "accuracy": 0.9866666666666667,
        "precision": 0.9846153846153847,
        "recall": 1.0,
        "f1": 0.9922480620155039
      },
      "test": {
        "accuracy": 0.98,
        "precision": 0.9761904761904762,
        "recall": 1.0,
        "f1": 0.9879518072289156
      }
    },
    {
      "layer": 14,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.9942857142857143,
        "precision": 0.9932432432432432,
        "recall": 1.0,
        "f1": 0.9966101694915255
      },
      "val": {
        "accuracy": 0.9866666666666667,
        "precision": 0.9846153846153847,
        "recall": 1.0,
        "f1": 0.9922480620155039
      },
      "test": {
        "accuracy": 0.98,
        "precision": 0.9761904761904762,
        "recall": 1.0,
        "f1": 0.9879518072289156
      }
    },
    {
      "layer": 15,
      "best_C": 0.1,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.9866666666666667,
        "precision": 0.9846153846153847,
        "recall": 1.0,
        "f1": 0.9922480620155039
      },
      "test": {
        "accuracy": 0.98,
        "precision": 0.9761904761904762,
        "recall": 1.0,
        "f1": 0.9879518072289156
      }
    },
    {
      "layer": 16,
      "best_C": 0.1,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.9866666666666667,
        "precision": 0.9846153846153847,
        "recall": 1.0,
        "f1": 0.9922480620155039
      },
      "test": {
        "accuracy": 0.98,
        "precision": 0.9761904761904762,
        "recall": 1.0,
        "f1": 0.9879518072289156
      }
    },
    {
      "layer": 17,
      "best_C": 0.1,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.9866666666666667,
        "precision": 0.9846153846153847,
        "recall": 1.0,
        "f1": 0.9922480620155039
      },
      "test": {
        "accuracy": 0.98,
        "precision": 0.9761904761904762,
        "recall": 1.0,
        "f1": 0.9879518072289156
      }
    },
    {
      "layer": 18,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.9942857142857143,
        "precision": 0.9949152542372881,
        "recall": 0.9982993197278912,
        "f1": 0.9966044142614601
      },
      "val": {
        "accuracy": 0.9866666666666667,
        "precision": 0.9846153846153847,
        "recall": 1.0,
        "f1": 0.9922480620155039
      },
      "test": {
        "accuracy": 0.98,
        "precision": 0.9761904761904762,
        "recall": 1.0,
        "f1": 0.9879518072289156
      }
    },
    {
      "layer": 19,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.9971428571428571,
        "precision": 0.9966101694915255,
        "recall": 1.0,
        "f1": 0.99830220713073
      },
      "val": {
        "accuracy": 0.98,
        "precision": 0.9770992366412213,
        "recall": 1.0,
        "f1": 0.9884169884169884
      },
      "test": {
        "accuracy": 0.98,
        "precision": 0.9761904761904762,
        "recall": 1.0,
        "f1": 0.9879518072289156
      }
    },
    {
      "layer": 20,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.9985714285714286,
        "precision": 0.99830220713073,
        "recall": 1.0,
        "f1": 0.9991503823279524
      },
      "val": {
        "accuracy": 0.98,
        "precision": 0.9770992366412213,
        "recall": 1.0,
        "f1": 0.9884169884169884
      },
      "test": {
        "accuracy": 0.98,
        "precision": 0.9761904761904762,
        "recall": 1.0,
        "f1": 0.9879518072289156
      }
    },
    {
      "layer": 21,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.9985714285714286,
        "precision": 0.99830220713073,
        "recall": 1.0,
        "f1": 0.9991503823279524
      },
      "val": {
        "accuracy": 0.98,
        "precision": 0.9770992366412213,
        "recall": 1.0,
        "f1": 0.9884169884169884
      },
      "test": {
        "accuracy": 0.98,
        "precision": 0.9761904761904762,
        "recall": 1.0,
        "f1": 0.9879518072289156
      }
    },
    {
      "layer": 22,
      "best_C": 0.1,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.98,
        "precision": 0.9770992366412213,
        "recall": 1.0,
        "f1": 0.9884169884169884
      },
      "test": {
        "accuracy": 0.98,
        "precision": 0.9761904761904762,
        "recall": 1.0,
        "f1": 0.9879518072289156
      }
    },
    {
      "layer": 23,
      "best_C": 0.1,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.98,
        "precision": 0.9770992366412213,
        "recall": 1.0,
        "f1": 0.9884169884169884
      },
      "test": {
        "accuracy": 0.98,
        "precision": 0.9761904761904762,
        "recall": 1.0,
        "f1": 0.9879518072289156
      }
    },
    {
      "layer": 24,
      "best_C": 0.01,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.98,
        "precision": 0.9770992366412213,
        "recall": 1.0,
        "f1": 0.9884169884169884
      },
      "test": {
        "accuracy": 0.98,
        "precision": 0.9761904761904762,
        "recall": 1.0,
        "f1": 0.9879518072289156
      }
    },
    {
      "layer": 25,
      "best_C": 0.01,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.98,
        "precision": 0.9770992366412213,
        "recall": 1.0,
        "f1": 0.9884169884169884
      },
      "test": {
        "accuracy": 0.98,
        "precision": 0.9761904761904762,
        "recall": 1.0,
        "f1": 0.9879518072289156
      }
    },
    {
      "layer": 26,
      "best_C": 0.01,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.98,
        "precision": 0.9770992366412213,
        "recall": 1.0,
        "f1": 0.9884169884169884
      },
      "test": {
        "accuracy": 0.98,
        "precision": 0.9761904761904762,
        "recall": 1.0,
        "f1": 0.9879518072289156
      }
    },
    {
      "layer": 27,
      "best_C": 0.1,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.98,
        "precision": 0.9770992366412213,
        "recall": 1.0,
        "f1": 0.9884169884169884
      },
      "test": {
        "accuracy": 0.9733333333333334,
        "precision": 0.968503937007874,
        "recall": 1.0,
        "f1": 0.984
      }
    },
    {
      "layer": 28,
      "best_C": 0.01,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.98,
        "precision": 0.9770992366412213,
        "recall": 1.0,
        "f1": 0.9884169884169884
      },
      "test": {
        "accuracy": 0.98,
        "precision": 0.9761904761904762,
        "recall": 1.0,
        "f1": 0.9879518072289156
      }
    },
    {
      "layer": 29,
      "best_C": 1.0,
      "train": {
        "accuracy": 0.9985714285714286,
        "precision": 0.99830220713073,
        "recall": 1.0,
        "f1": 0.9991503823279524
      },
      "val": {
        "accuracy": 0.98,
        "precision": 0.9770992366412213,
        "recall": 1.0,
        "f1": 0.9884169884169884
      },
      "test": {
        "accuracy": 0.98,
        "precision": 0.9761904761904762,
        "recall": 1.0,
        "f1": 0.9879518072289156
      }
    }
  ]
}