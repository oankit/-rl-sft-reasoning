{
  "model_name": "deepseek-ai/deepseek-math-7b-rl",
  "n_layers": 30,
  "n_train": 700,
  "n_val": 150,
  "n_test": 150,
  "n_total": 1000,
  "n_correct": 254,
  "n_incorrect": 746,
  "correct_ratio": 25.4,
  "class_weight": "balanced",
  "indices_path": "/Users/antyabharahman/Downloads/Personal/final_research/paper_codebase/-rl-sft-reasoning/experiment_code/layerwise_linear_probe/balanced_outputs/922/deepseek/balanced_indices_deepseek-math-7b-rl.json",
  "probe_config": {
    "cv_folds": 5,
    "C_range": [
      0.01,
      0.1,
      1.0,
      10.0,
      100.0
    ],
    "max_iter": 5000,
    "random_state": 42,
    "solver": "lbfgs"
  },
  "layer_results": [
    {
      "layer": 0,
      "best_C": 1.0,
      "train": {
        "accuracy": 0.9485714285714286,
        "precision": 0.8483412322274881,
        "recall": 0.9781420765027322,
        "f1": 0.9086294416243654
      },
      "val": {
        "accuracy": 0.9666666666666667,
        "precision": 0.875,
        "recall": 1.0,
        "f1": 0.9333333333333333
      },
      "test": {
        "accuracy": 0.94,
        "precision": 0.8461538461538461,
        "recall": 0.9166666666666666,
        "f1": 0.88
      }
    },
    {
      "layer": 1,
      "best_C": 0.1,
      "train": {
        "accuracy": 0.9471428571428572,
        "precision": 0.8509615384615384,
        "recall": 0.9672131147540983,
        "f1": 0.9053708439897699
      },
      "val": {
        "accuracy": 0.96,
        "precision": 0.8717948717948718,
        "recall": 0.9714285714285714,
        "f1": 0.918918918918919
      },
      "test": {
        "accuracy": 0.94,
        "precision": 0.8461538461538461,
        "recall": 0.9166666666666666,
        "f1": 0.88
      }
    },
    {
      "layer": 2,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.94,
        "precision": 0.8405797101449275,
        "recall": 0.9508196721311475,
        "f1": 0.8923076923076924
      },
      "val": {
        "accuracy": 0.9533333333333334,
        "precision": 0.868421052631579,
        "recall": 0.9428571428571428,
        "f1": 0.9041095890410958
      },
      "test": {
        "accuracy": 0.94,
        "precision": 0.8461538461538461,
        "recall": 0.9166666666666666,
        "f1": 0.88
      }
    },
    {
      "layer": 3,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.9414285714285714,
        "precision": 0.8413461538461539,
        "recall": 0.9562841530054644,
        "f1": 0.8951406649616368
      },
      "val": {
        "accuracy": 0.9666666666666667,
        "precision": 0.875,
        "recall": 1.0,
        "f1": 0.9333333333333333
      },
      "test": {
        "accuracy": 0.9466666666666667,
        "precision": 0.85,
        "recall": 0.9444444444444444,
        "f1": 0.8947368421052632
      }
    },
    {
      "layer": 4,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.9428571428571428,
        "precision": 0.8421052631578947,
        "recall": 0.9617486338797814,
        "f1": 0.8979591836734694
      },
      "val": {
        "accuracy": 0.9666666666666667,
        "precision": 0.875,
        "recall": 1.0,
        "f1": 0.9333333333333333
      },
      "test": {
        "accuracy": 0.9466666666666667,
        "precision": 0.85,
        "recall": 0.9444444444444444,
        "f1": 0.8947368421052632
      }
    },
    {
      "layer": 5,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.9442857142857143,
        "precision": 0.8428571428571429,
        "recall": 0.9672131147540983,
        "f1": 0.9007633587786259
      },
      "val": {
        "accuracy": 0.9666666666666667,
        "precision": 0.875,
        "recall": 1.0,
        "f1": 0.9333333333333333
      },
      "test": {
        "accuracy": 0.9466666666666667,
        "precision": 0.85,
        "recall": 0.9444444444444444,
        "f1": 0.8947368421052632
      }
    },
    {
      "layer": 6,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.9457142857142857,
        "precision": 0.8436018957345972,
        "recall": 0.9726775956284153,
        "f1": 0.9035532994923858
      },
      "val": {
        "accuracy": 0.9666666666666667,
        "precision": 0.875,
        "recall": 1.0,
        "f1": 0.9333333333333333
      },
      "test": {
        "accuracy": 0.9466666666666667,
        "precision": 0.85,
        "recall": 0.9444444444444444,
        "f1": 0.8947368421052632
      }
    },
    {
      "layer": 7,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.9514285714285714,
        "precision": 0.8465116279069768,
        "recall": 0.994535519125683,
        "f1": 0.914572864321608
      },
      "val": {
        "accuracy": 0.9666666666666667,
        "precision": 0.875,
        "recall": 1.0,
        "f1": 0.9333333333333333
      },
      "test": {
        "accuracy": 0.9466666666666667,
        "precision": 0.85,
        "recall": 0.9444444444444444,
        "f1": 0.8947368421052632
      }
    },
    {
      "layer": 8,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.9557142857142857,
        "precision": 0.8584905660377359,
        "recall": 0.994535519125683,
        "f1": 0.9215189873417722
      },
      "val": {
        "accuracy": 0.9666666666666667,
        "precision": 0.875,
        "recall": 1.0,
        "f1": 0.9333333333333333
      },
      "test": {
        "accuracy": 0.9466666666666667,
        "precision": 0.85,
        "recall": 0.9444444444444444,
        "f1": 0.8947368421052632
      }
    },
    {
      "layer": 9,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.9557142857142857,
        "precision": 0.8584905660377359,
        "recall": 0.994535519125683,
        "f1": 0.9215189873417722
      },
      "val": {
        "accuracy": 0.9666666666666667,
        "precision": 0.875,
        "recall": 1.0,
        "f1": 0.9333333333333333
      },
      "test": {
        "accuracy": 0.9466666666666667,
        "precision": 0.85,
        "recall": 0.9444444444444444,
        "f1": 0.8947368421052632
      }
    },
    {
      "layer": 10,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.96,
        "precision": 0.8672985781990521,
        "recall": 1.0,
        "f1": 0.9289340101522843
      },
      "val": {
        "accuracy": 0.9666666666666667,
        "precision": 0.875,
        "recall": 1.0,
        "f1": 0.9333333333333333
      },
      "test": {
        "accuracy": 0.9466666666666667,
        "precision": 0.85,
        "recall": 0.9444444444444444,
        "f1": 0.8947368421052632
      }
    },
    {
      "layer": 11,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.9614285714285714,
        "precision": 0.8714285714285714,
        "recall": 1.0,
        "f1": 0.9312977099236641
      },
      "val": {
        "accuracy": 0.9666666666666667,
        "precision": 0.875,
        "recall": 1.0,
        "f1": 0.9333333333333333
      },
      "test": {
        "accuracy": 0.9533333333333334,
        "precision": 0.8717948717948718,
        "recall": 0.9444444444444444,
        "f1": 0.9066666666666666
      }
    },
    {
      "layer": 12,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.9642857142857143,
        "precision": 0.8798076923076923,
        "recall": 1.0,
        "f1": 0.9360613810741688
      },
      "val": {
        "accuracy": 0.9666666666666667,
        "precision": 0.875,
        "recall": 1.0,
        "f1": 0.9333333333333333
      },
      "test": {
        "accuracy": 0.9533333333333334,
        "precision": 0.8717948717948718,
        "recall": 0.9444444444444444,
        "f1": 0.9066666666666666
      }
    },
    {
      "layer": 13,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.9657142857142857,
        "precision": 0.8840579710144928,
        "recall": 1.0,
        "f1": 0.9384615384615385
      },
      "val": {
        "accuracy": 0.9666666666666667,
        "precision": 0.875,
        "recall": 1.0,
        "f1": 0.9333333333333333
      },
      "test": {
        "accuracy": 0.96,
        "precision": 0.8947368421052632,
        "recall": 0.9444444444444444,
        "f1": 0.918918918918919
      }
    },
    {
      "layer": 14,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.9685714285714285,
        "precision": 0.8926829268292683,
        "recall": 1.0,
        "f1": 0.9432989690721649
      },
      "val": {
        "accuracy": 0.9666666666666667,
        "precision": 0.875,
        "recall": 1.0,
        "f1": 0.9333333333333333
      },
      "test": {
        "accuracy": 0.9533333333333334,
        "precision": 0.8717948717948718,
        "recall": 0.9444444444444444,
        "f1": 0.9066666666666666
      }
    },
    {
      "layer": 15,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.9728571428571429,
        "precision": 0.905940594059406,
        "recall": 1.0,
        "f1": 0.9506493506493506
      },
      "val": {
        "accuracy": 0.9666666666666667,
        "precision": 0.875,
        "recall": 1.0,
        "f1": 0.9333333333333333
      },
      "test": {
        "accuracy": 0.96,
        "precision": 0.8947368421052632,
        "recall": 0.9444444444444444,
        "f1": 0.918918918918919
      }
    },
    {
      "layer": 16,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.9757142857142858,
        "precision": 0.915,
        "recall": 1.0,
        "f1": 0.9556135770234987
      },
      "val": {
        "accuracy": 0.9666666666666667,
        "precision": 0.875,
        "recall": 1.0,
        "f1": 0.9333333333333333
      },
      "test": {
        "accuracy": 0.9533333333333334,
        "precision": 0.8717948717948718,
        "recall": 0.9444444444444444,
        "f1": 0.9066666666666666
      }
    },
    {
      "layer": 17,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.98,
        "precision": 0.9289340101522843,
        "recall": 1.0,
        "f1": 0.9631578947368421
      },
      "val": {
        "accuracy": 0.9666666666666667,
        "precision": 0.875,
        "recall": 1.0,
        "f1": 0.9333333333333333
      },
      "test": {
        "accuracy": 0.9533333333333334,
        "precision": 0.8717948717948718,
        "recall": 0.9444444444444444,
        "f1": 0.9066666666666666
      }
    },
    {
      "layer": 18,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.9842857142857143,
        "precision": 0.9432989690721649,
        "recall": 1.0,
        "f1": 0.9708222811671088
      },
      "val": {
        "accuracy": 0.9666666666666667,
        "precision": 0.875,
        "recall": 1.0,
        "f1": 0.9333333333333333
      },
      "test": {
        "accuracy": 0.9533333333333334,
        "precision": 0.8717948717948718,
        "recall": 0.9444444444444444,
        "f1": 0.9066666666666666
      }
    },
    {
      "layer": 19,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.9885714285714285,
        "precision": 0.9581151832460733,
        "recall": 1.0,
        "f1": 0.9786096256684492
      },
      "val": {
        "accuracy": 0.9733333333333334,
        "precision": 0.8974358974358975,
        "recall": 1.0,
        "f1": 0.9459459459459459
      },
      "test": {
        "accuracy": 0.9533333333333334,
        "precision": 0.8717948717948718,
        "recall": 0.9444444444444444,
        "f1": 0.9066666666666666
      }
    },
    {
      "layer": 20,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.9928571428571429,
        "precision": 0.973404255319149,
        "recall": 1.0,
        "f1": 0.9865229110512129
      },
      "val": {
        "accuracy": 0.9666666666666667,
        "precision": 0.8947368421052632,
        "recall": 0.9714285714285714,
        "f1": 0.9315068493150684
      },
      "test": {
        "accuracy": 0.9533333333333334,
        "precision": 0.8717948717948718,
        "recall": 0.9444444444444444,
        "f1": 0.9066666666666666
      }
    },
    {
      "layer": 21,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.9957142857142857,
        "precision": 0.9838709677419355,
        "recall": 1.0,
        "f1": 0.991869918699187
      },
      "val": {
        "accuracy": 0.9666666666666667,
        "precision": 0.8947368421052632,
        "recall": 0.9714285714285714,
        "f1": 0.9315068493150684
      },
      "test": {
        "accuracy": 0.9533333333333334,
        "precision": 0.8717948717948718,
        "recall": 0.9444444444444444,
        "f1": 0.9066666666666666
      }
    },
    {
      "layer": 22,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.9957142857142857,
        "precision": 0.9838709677419355,
        "recall": 1.0,
        "f1": 0.991869918699187
      },
      "val": {
        "accuracy": 0.9666666666666667,
        "precision": 0.8947368421052632,
        "recall": 0.9714285714285714,
        "f1": 0.9315068493150684
      },
      "test": {
        "accuracy": 0.9533333333333334,
        "precision": 0.8717948717948718,
        "recall": 0.9444444444444444,
        "f1": 0.9066666666666666
      }
    },
    {
      "layer": 23,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.9971428571428571,
        "precision": 0.9891891891891892,
        "recall": 1.0,
        "f1": 0.9945652173913043
      },
      "val": {
        "accuracy": 0.9666666666666667,
        "precision": 0.8947368421052632,
        "recall": 0.9714285714285714,
        "f1": 0.9315068493150684
      },
      "test": {
        "accuracy": 0.9466666666666667,
        "precision": 0.868421052631579,
        "recall": 0.9166666666666666,
        "f1": 0.8918918918918919
      }
    },
    {
      "layer": 24,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.9985714285714286,
        "precision": 0.9945652173913043,
        "recall": 1.0,
        "f1": 0.997275204359673
      },
      "val": {
        "accuracy": 0.9666666666666667,
        "precision": 0.8947368421052632,
        "recall": 0.9714285714285714,
        "f1": 0.9315068493150684
      },
      "test": {
        "accuracy": 0.9466666666666667,
        "precision": 0.868421052631579,
        "recall": 0.9166666666666666,
        "f1": 0.8918918918918919
      }
    },
    {
      "layer": 25,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.9985714285714286,
        "precision": 0.9945652173913043,
        "recall": 1.0,
        "f1": 0.997275204359673
      },
      "val": {
        "accuracy": 0.9666666666666667,
        "precision": 0.8947368421052632,
        "recall": 0.9714285714285714,
        "f1": 0.9315068493150684
      },
      "test": {
        "accuracy": 0.9466666666666667,
        "precision": 0.868421052631579,
        "recall": 0.9166666666666666,
        "f1": 0.8918918918918919
      }
    },
    {
      "layer": 26,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.9985714285714286,
        "precision": 0.9945652173913043,
        "recall": 1.0,
        "f1": 0.997275204359673
      },
      "val": {
        "accuracy": 0.9666666666666667,
        "precision": 0.8947368421052632,
        "recall": 0.9714285714285714,
        "f1": 0.9315068493150684
      },
      "test": {
        "accuracy": 0.9466666666666667,
        "precision": 0.868421052631579,
        "recall": 0.9166666666666666,
        "f1": 0.8918918918918919
      }
    },
    {
      "layer": 27,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.9985714285714286,
        "precision": 0.9945652173913043,
        "recall": 1.0,
        "f1": 0.997275204359673
      },
      "val": {
        "accuracy": 0.9666666666666667,
        "precision": 0.8947368421052632,
        "recall": 0.9714285714285714,
        "f1": 0.9315068493150684
      },
      "test": {
        "accuracy": 0.9466666666666667,
        "precision": 0.85,
        "recall": 0.9444444444444444,
        "f1": 0.8947368421052632
      }
    },
    {
      "layer": 28,
      "best_C": 0.1,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.9666666666666667,
        "precision": 0.8947368421052632,
        "recall": 0.9714285714285714,
        "f1": 0.9315068493150684
      },
      "test": {
        "accuracy": 0.9466666666666667,
        "precision": 0.85,
        "recall": 0.9444444444444444,
        "f1": 0.8947368421052632
      }
    },
    {
      "layer": 29,
      "best_C": 0.01,
      "train": {
        "accuracy": 0.9371428571428572,
        "precision": 0.8357487922705314,
        "recall": 0.9453551912568307,
        "f1": 0.8871794871794871
      },
      "val": {
        "accuracy": 0.9666666666666667,
        "precision": 0.875,
        "recall": 1.0,
        "f1": 0.9333333333333333
      },
      "test": {
        "accuracy": 0.9466666666666667,
        "precision": 0.85,
        "recall": 0.9444444444444444,
        "f1": 0.8947368421052632
      }
    }
  ]
}