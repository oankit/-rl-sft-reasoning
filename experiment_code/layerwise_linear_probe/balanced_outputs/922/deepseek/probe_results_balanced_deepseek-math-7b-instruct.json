{
  "model_name": "deepseek-ai/deepseek-math-7b-instruct",
  "n_layers": 30,
  "n_train": 700,
  "n_val": 150,
  "n_test": 150,
  "n_total": 1000,
  "n_correct": 832,
  "n_incorrect": 168,
  "correct_ratio": 83.2,
  "class_weight": "balanced",
  "indices_path": "/Users/antyabharahman/Downloads/Personal/final_research/paper_codebase/-rl-sft-reasoning/experiment_code/layerwise_linear_probe/balanced_outputs/922/deepseek/balanced_indices_deepseek-math-7b-instruct.json",
  "probe_config": {
    "cv_folds": 5,
    "C_range": [
      0.01,
      0.1,
      1.0,
      10.0,
      100.0
    ],
    "max_iter": 5000,
    "random_state": 42,
    "solver": "lbfgs"
  },
  "layer_results": [
    {
      "layer": 0,
      "best_C": 100.0,
      "train": {
        "accuracy": 0.7385714285714285,
        "precision": 0.947136563876652,
        "recall": 0.7300509337860781,
        "f1": 0.8245445829338447
      },
      "val": {
        "accuracy": 0.6466666666666666,
        "precision": 0.8350515463917526,
        "recall": 0.6864406779661016,
        "f1": 0.7534883720930232
      },
      "test": {
        "accuracy": 0.7066666666666667,
        "precision": 0.8932038834951457,
        "recall": 0.736,
        "f1": 0.8070175438596491
      }
    },
    {
      "layer": 1,
      "best_C": 100.0,
      "train": {
        "accuracy": 0.83,
        "precision": 0.9855371900826446,
        "recall": 0.8098471986417657,
        "f1": 0.8890959925442684
      },
      "val": {
        "accuracy": 0.6733333333333333,
        "precision": 0.8165137614678899,
        "recall": 0.7542372881355932,
        "f1": 0.7841409691629956
      },
      "test": {
        "accuracy": 0.6666666666666666,
        "precision": 0.8440366972477065,
        "recall": 0.736,
        "f1": 0.7863247863247863
      }
    },
    {
      "layer": 2,
      "best_C": 100.0,
      "train": {
        "accuracy": 0.9042857142857142,
        "precision": 0.9943181818181818,
        "recall": 0.8913412563667232,
        "f1": 0.9400179051029544
      },
      "val": {
        "accuracy": 0.7266666666666667,
        "precision": 0.8235294117647058,
        "recall": 0.8305084745762712,
        "f1": 0.8270042194092827
      },
      "test": {
        "accuracy": 0.6933333333333334,
        "precision": 0.8623853211009175,
        "recall": 0.752,
        "f1": 0.8034188034188035
      }
    },
    {
      "layer": 3,
      "best_C": 100.0,
      "train": {
        "accuracy": 0.9528571428571428,
        "precision": 1.0,
        "recall": 0.9439728353140917,
        "f1": 0.97117903930131
      },
      "val": {
        "accuracy": 0.7133333333333334,
        "precision": 0.8048780487804879,
        "recall": 0.8389830508474576,
        "f1": 0.8215767634854771
      },
      "test": {
        "accuracy": 0.7266666666666667,
        "precision": 0.8387096774193549,
        "recall": 0.832,
        "f1": 0.8353413654618473
      }
    },
    {
      "layer": 4,
      "best_C": 100.0,
      "train": {
        "accuracy": 0.98,
        "precision": 1.0,
        "recall": 0.9762308998302207,
        "f1": 0.9879725085910653
      },
      "val": {
        "accuracy": 0.72,
        "precision": 0.796875,
        "recall": 0.864406779661017,
        "f1": 0.8292682926829268
      },
      "test": {
        "accuracy": 0.76,
        "precision": 0.8617886178861789,
        "recall": 0.848,
        "f1": 0.8548387096774194
      }
    },
    {
      "layer": 5,
      "best_C": 100.0,
      "train": {
        "accuracy": 0.9914285714285714,
        "precision": 1.0,
        "recall": 0.9898132427843803,
        "f1": 0.9948805460750854
      },
      "val": {
        "accuracy": 0.7266666666666667,
        "precision": 0.808,
        "recall": 0.8559322033898306,
        "f1": 0.831275720164609
      },
      "test": {
        "accuracy": 0.7666666666666667,
        "precision": 0.8571428571428571,
        "recall": 0.864,
        "f1": 0.8605577689243028
      }
    },
    {
      "layer": 6,
      "best_C": 100.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.72,
        "precision": 0.796875,
        "recall": 0.864406779661017,
        "f1": 0.8292682926829268
      },
      "test": {
        "accuracy": 0.76,
        "precision": 0.8449612403100775,
        "recall": 0.872,
        "f1": 0.8582677165354331
      }
    },
    {
      "layer": 7,
      "best_C": 100.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.7466666666666667,
        "precision": 0.803030303030303,
        "recall": 0.8983050847457628,
        "f1": 0.848
      },
      "test": {
        "accuracy": 0.8,
        "precision": 0.8518518518518519,
        "recall": 0.92,
        "f1": 0.8846153846153846
      }
    },
    {
      "layer": 8,
      "best_C": 100.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.76,
        "precision": 0.8106060606060606,
        "recall": 0.9067796610169492,
        "f1": 0.856
      },
      "test": {
        "accuracy": 0.7733333333333333,
        "precision": 0.8582677165354331,
        "recall": 0.872,
        "f1": 0.8650793650793651
      }
    },
    {
      "layer": 9,
      "best_C": 100.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.76,
        "precision": 0.8203125,
        "recall": 0.8898305084745762,
        "f1": 0.8536585365853658
      },
      "test": {
        "accuracy": 0.8133333333333334,
        "precision": 0.8646616541353384,
        "recall": 0.92,
        "f1": 0.8914728682170543
      }
    },
    {
      "layer": 10,
      "best_C": 100.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.7733333333333333,
        "precision": 0.823076923076923,
        "recall": 0.9067796610169492,
        "f1": 0.8629032258064516
      },
      "test": {
        "accuracy": 0.8066666666666666,
        "precision": 0.8582089552238806,
        "recall": 0.92,
        "f1": 0.888030888030888
      }
    },
    {
      "layer": 11,
      "best_C": 100.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.74,
        "precision": 0.8062015503875969,
        "recall": 0.8813559322033898,
        "f1": 0.8421052631578947
      },
      "test": {
        "accuracy": 0.82,
        "precision": 0.8769230769230769,
        "recall": 0.912,
        "f1": 0.8941176470588236
      }
    },
    {
      "layer": 12,
      "best_C": 100.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.74,
        "precision": 0.8015267175572519,
        "recall": 0.8898305084745762,
        "f1": 0.8433734939759037
      },
      "test": {
        "accuracy": 0.8066666666666666,
        "precision": 0.8692307692307693,
        "recall": 0.904,
        "f1": 0.8862745098039215
      }
    },
    {
      "layer": 13,
      "best_C": 100.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.76,
        "precision": 0.8106060606060606,
        "recall": 0.9067796610169492,
        "f1": 0.856
      },
      "test": {
        "accuracy": 0.8533333333333334,
        "precision": 0.8931297709923665,
        "recall": 0.936,
        "f1": 0.9140625
      }
    },
    {
      "layer": 14,
      "best_C": 100.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.78,
        "precision": 0.8057553956834532,
        "recall": 0.9491525423728814,
        "f1": 0.8715953307392996
      },
      "test": {
        "accuracy": 0.7933333333333333,
        "precision": 0.8671875,
        "recall": 0.888,
        "f1": 0.8774703557312253
      }
    },
    {
      "layer": 15,
      "best_C": 100.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.7466666666666667,
        "precision": 0.803030303030303,
        "recall": 0.8983050847457628,
        "f1": 0.848
      },
      "test": {
        "accuracy": 0.8,
        "precision": 0.8740157480314961,
        "recall": 0.888,
        "f1": 0.8809523809523809
      }
    },
    {
      "layer": 16,
      "best_C": 1.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.74,
        "precision": 0.8062015503875969,
        "recall": 0.8813559322033898,
        "f1": 0.8421052631578947
      },
      "test": {
        "accuracy": 0.7733333333333333,
        "precision": 0.8582677165354331,
        "recall": 0.872,
        "f1": 0.8650793650793651
      }
    },
    {
      "layer": 17,
      "best_C": 100.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.7666666666666667,
        "precision": 0.8074074074074075,
        "recall": 0.923728813559322,
        "f1": 0.8616600790513834
      },
      "test": {
        "accuracy": 0.78,
        "precision": 0.8538461538461538,
        "recall": 0.888,
        "f1": 0.8705882352941177
      }
    },
    {
      "layer": 18,
      "best_C": 1.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.74,
        "precision": 0.8062015503875969,
        "recall": 0.8813559322033898,
        "f1": 0.8421052631578947
      },
      "test": {
        "accuracy": 0.8066666666666666,
        "precision": 0.8636363636363636,
        "recall": 0.912,
        "f1": 0.8871595330739299
      }
    },
    {
      "layer": 19,
      "best_C": 10.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.78,
        "precision": 0.8148148148148148,
        "recall": 0.9322033898305084,
        "f1": 0.8695652173913043
      },
      "test": {
        "accuracy": 0.8,
        "precision": 0.8571428571428571,
        "recall": 0.912,
        "f1": 0.8837209302325582
      }
    },
    {
      "layer": 20,
      "best_C": 1.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.76,
        "precision": 0.8153846153846154,
        "recall": 0.8983050847457628,
        "f1": 0.8548387096774194
      },
      "test": {
        "accuracy": 0.7933333333333333,
        "precision": 0.8560606060606061,
        "recall": 0.904,
        "f1": 0.8793774319066148
      }
    },
    {
      "layer": 21,
      "best_C": 1.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.7733333333333333,
        "precision": 0.8134328358208955,
        "recall": 0.923728813559322,
        "f1": 0.8650793650793651
      },
      "test": {
        "accuracy": 0.78,
        "precision": 0.8538461538461538,
        "recall": 0.888,
        "f1": 0.8705882352941177
      }
    },
    {
      "layer": 22,
      "best_C": 10.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.7733333333333333,
        "precision": 0.8134328358208955,
        "recall": 0.923728813559322,
        "f1": 0.8650793650793651
      },
      "test": {
        "accuracy": 0.7933333333333333,
        "precision": 0.8671875,
        "recall": 0.888,
        "f1": 0.8774703557312253
      }
    },
    {
      "layer": 23,
      "best_C": 1.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.7666666666666667,
        "precision": 0.8120300751879699,
        "recall": 0.9152542372881356,
        "f1": 0.8605577689243028
      },
      "test": {
        "accuracy": 0.7866666666666666,
        "precision": 0.8604651162790697,
        "recall": 0.888,
        "f1": 0.8740157480314961
      }
    },
    {
      "layer": 24,
      "best_C": 100.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.74,
        "precision": 0.7969924812030075,
        "recall": 0.8983050847457628,
        "f1": 0.8446215139442231
      },
      "test": {
        "accuracy": 0.7666666666666667,
        "precision": 0.8461538461538461,
        "recall": 0.88,
        "f1": 0.8627450980392157
      }
    },
    {
      "layer": 25,
      "best_C": 10.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.7533333333333333,
        "precision": 0.8045112781954887,
        "recall": 0.9067796610169492,
        "f1": 0.852589641434263
      },
      "test": {
        "accuracy": 0.7733333333333333,
        "precision": 0.8473282442748091,
        "recall": 0.888,
        "f1": 0.8671875
      }
    },
    {
      "layer": 26,
      "best_C": 1.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.7733333333333333,
        "precision": 0.8134328358208955,
        "recall": 0.923728813559322,
        "f1": 0.8650793650793651
      },
      "test": {
        "accuracy": 0.78,
        "precision": 0.8484848484848485,
        "recall": 0.896,
        "f1": 0.8715953307392996
      }
    },
    {
      "layer": 27,
      "best_C": 1.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.7733333333333333,
        "precision": 0.8134328358208955,
        "recall": 0.923728813559322,
        "f1": 0.8650793650793651
      },
      "test": {
        "accuracy": 0.7866666666666666,
        "precision": 0.8549618320610687,
        "recall": 0.896,
        "f1": 0.875
      }
    },
    {
      "layer": 28,
      "best_C": 0.1,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.76,
        "precision": 0.8106060606060606,
        "recall": 0.9067796610169492,
        "f1": 0.856
      },
      "test": {
        "accuracy": 0.7866666666666666,
        "precision": 0.8549618320610687,
        "recall": 0.896,
        "f1": 0.875
      }
    },
    {
      "layer": 29,
      "best_C": 100.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.7733333333333333,
        "precision": 0.8181818181818182,
        "recall": 0.9152542372881356,
        "f1": 0.864
      },
      "test": {
        "accuracy": 0.8,
        "precision": 0.8625954198473282,
        "recall": 0.904,
        "f1": 0.8828125
      }
    }
  ]
}