{
  "model_name": "deepseek-ai/deepseek-math-7b-base",
  "n_layers": 30,
  "n_train": 268,
  "n_val": 57,
  "n_test": 59,
  "n_balanced_total": 384,
  "n_balanced_correct": 115,
  "n_balanced_incorrect": 269,
  "balanced_indices_path": "/Users/antyabharahman/Downloads/Personal/final_research/paper_codebase/-rl-sft-reasoning/experiment_code/layerwise_linear_probe/balanced_outputs/922/deepseek/balanced_indices_deepseek-math-7b-base.json",
  "probe_config": {
    "cv_folds": 5,
    "C_range": [
      0.01,
      0.1,
      1.0,
      10.0,
      100.0
    ],
    "max_iter": 5000,
    "random_state": 42,
    "solver": "lbfgs"
  },
  "layer_results": [
    {
      "layer": 0,
      "best_C": 0.1,
      "train": {
        "accuracy": 0.6865671641791045,
        "precision": 0.4888888888888889,
        "recall": 0.8148148148148148,
        "f1": 0.6111111111111112
      },
      "val": {
        "accuracy": 0.5964912280701754,
        "precision": 0.28,
        "recall": 0.5833333333333334,
        "f1": 0.3783783783783784
      },
      "test": {
        "accuracy": 0.7796610169491526,
        "precision": 0.68,
        "recall": 0.7727272727272727,
        "f1": 0.723404255319149
      }
    },
    {
      "layer": 1,
      "best_C": 10.0,
      "train": {
        "accuracy": 0.9850746268656716,
        "precision": 0.9529411764705882,
        "recall": 1.0,
        "f1": 0.9759036144578314
      },
      "val": {
        "accuracy": 0.6140350877192983,
        "precision": 0.1875,
        "recall": 0.25,
        "f1": 0.21428571428571427
      },
      "test": {
        "accuracy": 0.6610169491525424,
        "precision": 0.5454545454545454,
        "recall": 0.5454545454545454,
        "f1": 0.5454545454545454
      }
    },
    {
      "layer": 2,
      "best_C": 10.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.6140350877192983,
        "precision": 0.14285714285714285,
        "recall": 0.16666666666666666,
        "f1": 0.15384615384615385
      },
      "test": {
        "accuracy": 0.6440677966101694,
        "precision": 0.5263157894736842,
        "recall": 0.45454545454545453,
        "f1": 0.4878048780487805
      }
    },
    {
      "layer": 3,
      "best_C": 10.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.631578947368421,
        "precision": 0.2,
        "recall": 0.25,
        "f1": 0.2222222222222222
      },
      "test": {
        "accuracy": 0.5932203389830508,
        "precision": 0.45,
        "recall": 0.4090909090909091,
        "f1": 0.42857142857142855
      }
    },
    {
      "layer": 4,
      "best_C": 100.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.631578947368421,
        "precision": 0.15384615384615385,
        "recall": 0.16666666666666666,
        "f1": 0.16
      },
      "test": {
        "accuracy": 0.6101694915254238,
        "precision": 0.47368421052631576,
        "recall": 0.4090909090909091,
        "f1": 0.43902439024390244
      }
    },
    {
      "layer": 5,
      "best_C": 100.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.6140350877192983,
        "precision": 0.1875,
        "recall": 0.25,
        "f1": 0.21428571428571427
      },
      "test": {
        "accuracy": 0.6271186440677966,
        "precision": 0.5,
        "recall": 0.3181818181818182,
        "f1": 0.3888888888888889
      }
    },
    {
      "layer": 6,
      "best_C": 0.1,
      "train": {
        "accuracy": 0.9701492537313433,
        "precision": 0.9101123595505618,
        "recall": 1.0,
        "f1": 0.9529411764705882
      },
      "val": {
        "accuracy": 0.6140350877192983,
        "precision": 0.1875,
        "recall": 0.25,
        "f1": 0.21428571428571427
      },
      "test": {
        "accuracy": 0.6779661016949152,
        "precision": 0.5882352941176471,
        "recall": 0.45454545454545453,
        "f1": 0.5128205128205128
      }
    },
    {
      "layer": 7,
      "best_C": 1.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.6666666666666666,
        "precision": 0.26666666666666666,
        "recall": 0.3333333333333333,
        "f1": 0.2962962962962963
      },
      "test": {
        "accuracy": 0.6271186440677966,
        "precision": 0.5,
        "recall": 0.5,
        "f1": 0.5
      }
    },
    {
      "layer": 8,
      "best_C": 10.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.6140350877192983,
        "precision": 0.1875,
        "recall": 0.25,
        "f1": 0.21428571428571427
      },
      "test": {
        "accuracy": 0.711864406779661,
        "precision": 0.6470588235294118,
        "recall": 0.5,
        "f1": 0.5641025641025641
      }
    },
    {
      "layer": 9,
      "best_C": 10.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.7192982456140351,
        "precision": 0.35714285714285715,
        "recall": 0.4166666666666667,
        "f1": 0.38461538461538464
      },
      "test": {
        "accuracy": 0.6779661016949152,
        "precision": 0.6,
        "recall": 0.4090909090909091,
        "f1": 0.4864864864864865
      }
    },
    {
      "layer": 10,
      "best_C": 1.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.7543859649122807,
        "precision": 0.42857142857142855,
        "recall": 0.5,
        "f1": 0.46153846153846156
      },
      "test": {
        "accuracy": 0.6779661016949152,
        "precision": 0.5789473684210527,
        "recall": 0.5,
        "f1": 0.5365853658536586
      }
    },
    {
      "layer": 11,
      "best_C": 0.1,
      "train": {
        "accuracy": 0.996268656716418,
        "precision": 0.9878048780487805,
        "recall": 1.0,
        "f1": 0.9938650306748467
      },
      "val": {
        "accuracy": 0.6666666666666666,
        "precision": 0.26666666666666666,
        "recall": 0.3333333333333333,
        "f1": 0.2962962962962963
      },
      "test": {
        "accuracy": 0.6440677966101694,
        "precision": 0.5294117647058824,
        "recall": 0.4090909090909091,
        "f1": 0.46153846153846156
      }
    },
    {
      "layer": 12,
      "best_C": 0.1,
      "train": {
        "accuracy": 0.996268656716418,
        "precision": 0.9878048780487805,
        "recall": 1.0,
        "f1": 0.9938650306748467
      },
      "val": {
        "accuracy": 0.6666666666666666,
        "precision": 0.29411764705882354,
        "recall": 0.4166666666666667,
        "f1": 0.3448275862068966
      },
      "test": {
        "accuracy": 0.559322033898305,
        "precision": 0.375,
        "recall": 0.2727272727272727,
        "f1": 0.3157894736842105
      }
    },
    {
      "layer": 13,
      "best_C": 0.1,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.7192982456140351,
        "precision": 0.375,
        "recall": 0.5,
        "f1": 0.42857142857142855
      },
      "test": {
        "accuracy": 0.6440677966101694,
        "precision": 0.5263157894736842,
        "recall": 0.45454545454545453,
        "f1": 0.4878048780487805
      }
    },
    {
      "layer": 14,
      "best_C": 10.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.7192982456140351,
        "precision": 0.375,
        "recall": 0.5,
        "f1": 0.42857142857142855
      },
      "test": {
        "accuracy": 0.6440677966101694,
        "precision": 0.5238095238095238,
        "recall": 0.5,
        "f1": 0.5116279069767442
      }
    },
    {
      "layer": 15,
      "best_C": 100.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.7017543859649122,
        "precision": 0.3684210526315789,
        "recall": 0.5833333333333334,
        "f1": 0.45161290322580644
      },
      "test": {
        "accuracy": 0.6440677966101694,
        "precision": 0.5294117647058824,
        "recall": 0.4090909090909091,
        "f1": 0.46153846153846156
      }
    },
    {
      "layer": 16,
      "best_C": 0.1,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.7017543859649122,
        "precision": 0.3333333333333333,
        "recall": 0.4166666666666667,
        "f1": 0.37037037037037035
      },
      "test": {
        "accuracy": 0.6271186440677966,
        "precision": 0.5,
        "recall": 0.4090909090909091,
        "f1": 0.45
      }
    },
    {
      "layer": 17,
      "best_C": 1.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.7017543859649122,
        "precision": 0.3333333333333333,
        "recall": 0.4166666666666667,
        "f1": 0.37037037037037035
      },
      "test": {
        "accuracy": 0.6271186440677966,
        "precision": 0.5,
        "recall": 0.36363636363636365,
        "f1": 0.42105263157894735
      }
    },
    {
      "layer": 18,
      "best_C": 0.01,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.7017543859649122,
        "precision": 0.35294117647058826,
        "recall": 0.5,
        "f1": 0.41379310344827586
      },
      "test": {
        "accuracy": 0.576271186440678,
        "precision": 0.42105263157894735,
        "recall": 0.36363636363636365,
        "f1": 0.3902439024390244
      }
    },
    {
      "layer": 19,
      "best_C": 0.1,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.7368421052631579,
        "precision": 0.4,
        "recall": 0.5,
        "f1": 0.4444444444444444
      },
      "test": {
        "accuracy": 0.6101694915254238,
        "precision": 0.47619047619047616,
        "recall": 0.45454545454545453,
        "f1": 0.46511627906976744
      }
    },
    {
      "layer": 20,
      "best_C": 0.1,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.7192982456140351,
        "precision": 0.3888888888888889,
        "recall": 0.5833333333333334,
        "f1": 0.4666666666666667
      },
      "test": {
        "accuracy": 0.6440677966101694,
        "precision": 0.5238095238095238,
        "recall": 0.5,
        "f1": 0.5116279069767442
      }
    },
    {
      "layer": 21,
      "best_C": 0.01,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.7192982456140351,
        "precision": 0.3333333333333333,
        "recall": 0.3333333333333333,
        "f1": 0.3333333333333333
      },
      "test": {
        "accuracy": 0.6779661016949152,
        "precision": 0.5789473684210527,
        "recall": 0.5,
        "f1": 0.5365853658536586
      }
    },
    {
      "layer": 22,
      "best_C": 0.01,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.7192982456140351,
        "precision": 0.375,
        "recall": 0.5,
        "f1": 0.42857142857142855
      },
      "test": {
        "accuracy": 0.6949152542372882,
        "precision": 0.5909090909090909,
        "recall": 0.5909090909090909,
        "f1": 0.5909090909090909
      }
    },
    {
      "layer": 23,
      "best_C": 1.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.7192982456140351,
        "precision": 0.4,
        "recall": 0.6666666666666666,
        "f1": 0.5
      },
      "test": {
        "accuracy": 0.6440677966101694,
        "precision": 0.5238095238095238,
        "recall": 0.5,
        "f1": 0.5116279069767442
      }
    },
    {
      "layer": 24,
      "best_C": 0.01,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.7543859649122807,
        "precision": 0.4444444444444444,
        "recall": 0.6666666666666666,
        "f1": 0.5333333333333333
      },
      "test": {
        "accuracy": 0.6779661016949152,
        "precision": 0.5652173913043478,
        "recall": 0.5909090909090909,
        "f1": 0.5777777777777777
      }
    },
    {
      "layer": 25,
      "best_C": 0.01,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.7543859649122807,
        "precision": 0.4375,
        "recall": 0.5833333333333334,
        "f1": 0.5
      },
      "test": {
        "accuracy": 0.6779661016949152,
        "precision": 0.5652173913043478,
        "recall": 0.5909090909090909,
        "f1": 0.5777777777777777
      }
    },
    {
      "layer": 26,
      "best_C": 10.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.7368421052631579,
        "precision": 0.4117647058823529,
        "recall": 0.5833333333333334,
        "f1": 0.4827586206896552
      },
      "test": {
        "accuracy": 0.6271186440677966,
        "precision": 0.5,
        "recall": 0.5,
        "f1": 0.5
      }
    },
    {
      "layer": 27,
      "best_C": 0.1,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.7017543859649122,
        "precision": 0.35294117647058826,
        "recall": 0.5,
        "f1": 0.41379310344827586
      },
      "test": {
        "accuracy": 0.6949152542372882,
        "precision": 0.6,
        "recall": 0.5454545454545454,
        "f1": 0.5714285714285714
      }
    },
    {
      "layer": 28,
      "best_C": 0.1,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.7192982456140351,
        "precision": 0.375,
        "recall": 0.5,
        "f1": 0.42857142857142855
      },
      "test": {
        "accuracy": 0.6779661016949152,
        "precision": 0.5652173913043478,
        "recall": 0.5909090909090909,
        "f1": 0.5777777777777777
      }
    },
    {
      "layer": 29,
      "best_C": 1.0,
      "train": {
        "accuracy": 0.9925373134328358,
        "precision": 0.9759036144578314,
        "recall": 1.0,
        "f1": 0.9878048780487805
      },
      "val": {
        "accuracy": 0.7192982456140351,
        "precision": 0.35714285714285715,
        "recall": 0.4166666666666667,
        "f1": 0.38461538461538464
      },
      "test": {
        "accuracy": 0.6949152542372882,
        "precision": 0.5909090909090909,
        "recall": 0.5909090909090909,
        "f1": 0.5909090909090909
      }
    }
  ]
}