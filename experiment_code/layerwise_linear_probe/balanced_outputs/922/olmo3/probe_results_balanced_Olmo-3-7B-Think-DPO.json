{
  "model_name": "allenai/Olmo-3-7B-Think-DPO",
  "n_layers": 32,
  "n_train": 700,
  "n_val": 150,
  "n_test": 150,
  "n_total": 1000,
  "n_correct": 926,
  "n_incorrect": 74,
  "correct_ratio": 92.6,
  "class_weight": "balanced",
  "indices_path": "/Users/antyabharahman/Downloads/Personal/final_research/paper_codebase/-rl-sft-reasoning/experiment_code/layerwise_linear_probe/balanced_outputs/922/olmo3/balanced_indices_Olmo-3-7B-Think-DPO.json",
  "probe_config": {
    "cv_folds": 5,
    "C_range": [
      0.01,
      0.1,
      1.0,
      10.0,
      100.0
    ],
    "max_iter": 5000,
    "random_state": 42,
    "solver": "lbfgs"
  },
  "layer_results": [
    {
      "layer": 0,
      "best_C": 100.0,
      "train": {
        "accuracy": 0.7385714285714285,
        "precision": 0.9876288659793815,
        "recall": 0.7301829268292683,
        "f1": 0.8396143733567046
      },
      "val": {
        "accuracy": 0.7333333333333333,
        "precision": 0.9181818181818182,
        "recall": 0.7651515151515151,
        "f1": 0.8347107438016529
      },
      "test": {
        "accuracy": 0.7466666666666667,
        "precision": 0.9629629629629629,
        "recall": 0.7536231884057971,
        "f1": 0.8455284552845529
      }
    },
    {
      "layer": 1,
      "best_C": 100.0,
      "train": {
        "accuracy": 0.8357142857142857,
        "precision": 0.998158379373849,
        "recall": 0.8262195121951219,
        "f1": 0.9040867389491243
      },
      "val": {
        "accuracy": 0.8,
        "precision": 0.925,
        "recall": 0.8409090909090909,
        "f1": 0.8809523809523809
      },
      "test": {
        "accuracy": 0.74,
        "precision": 0.9541284403669725,
        "recall": 0.7536231884057971,
        "f1": 0.8421052631578947
      }
    },
    {
      "layer": 2,
      "best_C": 100.0,
      "train": {
        "accuracy": 0.8785714285714286,
        "precision": 1.0,
        "recall": 0.8704268292682927,
        "f1": 0.9307253463732681
      },
      "val": {
        "accuracy": 0.8066666666666666,
        "precision": 0.9186991869918699,
        "recall": 0.8560606060606061,
        "f1": 0.8862745098039215
      },
      "test": {
        "accuracy": 0.8066666666666666,
        "precision": 0.9658119658119658,
        "recall": 0.8188405797101449,
        "f1": 0.8862745098039215
      }
    },
    {
      "layer": 3,
      "best_C": 100.0,
      "train": {
        "accuracy": 0.9242857142857143,
        "precision": 1.0,
        "recall": 0.9192073170731707,
        "f1": 0.9579030976965845
      },
      "val": {
        "accuracy": 0.8266666666666667,
        "precision": 0.9140625,
        "recall": 0.8863636363636364,
        "f1": 0.9
      },
      "test": {
        "accuracy": 0.8533333333333334,
        "precision": 0.9603174603174603,
        "recall": 0.8768115942028986,
        "f1": 0.9166666666666666
      }
    },
    {
      "layer": 4,
      "best_C": 100.0,
      "train": {
        "accuracy": 0.94,
        "precision": 1.0,
        "recall": 0.9359756097560976,
        "f1": 0.9669291338582677
      },
      "val": {
        "accuracy": 0.84,
        "precision": 0.9029850746268657,
        "recall": 0.9166666666666666,
        "f1": 0.9097744360902256
      },
      "test": {
        "accuracy": 0.8466666666666667,
        "precision": 0.9389312977099237,
        "recall": 0.8913043478260869,
        "f1": 0.9144981412639405
      }
    },
    {
      "layer": 5,
      "best_C": 100.0,
      "train": {
        "accuracy": 0.9671428571428572,
        "precision": 1.0,
        "recall": 0.9649390243902439,
        "f1": 0.9821567106283942
      },
      "val": {
        "accuracy": 0.86,
        "precision": 0.9111111111111111,
        "recall": 0.9318181818181818,
        "f1": 0.9213483146067416
      },
      "test": {
        "accuracy": 0.8666666666666667,
        "precision": 0.9538461538461539,
        "recall": 0.8985507246376812,
        "f1": 0.9253731343283582
      }
    },
    {
      "layer": 6,
      "best_C": 100.0,
      "train": {
        "accuracy": 0.9814285714285714,
        "precision": 1.0,
        "recall": 0.9801829268292683,
        "f1": 0.9899923017705927
      },
      "val": {
        "accuracy": 0.8733333333333333,
        "precision": 0.9064748201438849,
        "recall": 0.9545454545454546,
        "f1": 0.9298892988929889
      },
      "test": {
        "accuracy": 0.8733333333333333,
        "precision": 0.9407407407407408,
        "recall": 0.9202898550724637,
        "f1": 0.9304029304029304
      }
    },
    {
      "layer": 7,
      "best_C": 100.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.88,
        "precision": 0.8958333333333334,
        "recall": 0.9772727272727273,
        "f1": 0.9347826086956522
      },
      "test": {
        "accuracy": 0.9133333333333333,
        "precision": 0.9562043795620438,
        "recall": 0.9492753623188406,
        "f1": 0.9527272727272728
      }
    },
    {
      "layer": 8,
      "best_C": 100.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.9133333333333333,
        "precision": 0.9219858156028369,
        "recall": 0.9848484848484849,
        "f1": 0.9523809523809523
      },
      "test": {
        "accuracy": 0.96,
        "precision": 0.9782608695652174,
        "recall": 0.9782608695652174,
        "f1": 0.9782608695652174
      }
    },
    {
      "layer": 9,
      "best_C": 100.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.8733333333333333,
        "precision": 0.9124087591240876,
        "recall": 0.946969696969697,
        "f1": 0.929368029739777
      },
      "test": {
        "accuracy": 0.9533333333333334,
        "precision": 0.9645390070921985,
        "recall": 0.9855072463768116,
        "f1": 0.974910394265233
      }
    },
    {
      "layer": 10,
      "best_C": 100.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.9133333333333333,
        "precision": 0.9407407407407408,
        "recall": 0.9621212121212122,
        "f1": 0.951310861423221
      },
      "test": {
        "accuracy": 0.96,
        "precision": 0.9782608695652174,
        "recall": 0.9782608695652174,
        "f1": 0.9782608695652174
      }
    },
    {
      "layer": 11,
      "best_C": 100.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.9066666666666666,
        "precision": 0.9402985074626866,
        "recall": 0.9545454545454546,
        "f1": 0.9473684210526315
      },
      "test": {
        "accuracy": 0.9466666666666667,
        "precision": 0.9710144927536232,
        "recall": 0.9710144927536232,
        "f1": 0.9710144927536232
      }
    },
    {
      "layer": 12,
      "best_C": 10.0,
      "train": {
        "accuracy": 0.9971428571428571,
        "precision": 1.0,
        "recall": 0.9969512195121951,
        "f1": 0.9984732824427481
      },
      "val": {
        "accuracy": 0.9,
        "precision": 0.9398496240601504,
        "recall": 0.946969696969697,
        "f1": 0.9433962264150944
      },
      "test": {
        "accuracy": 0.9466666666666667,
        "precision": 0.9779411764705882,
        "recall": 0.9637681159420289,
        "f1": 0.9708029197080292
      }
    },
    {
      "layer": 13,
      "best_C": 100.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.92,
        "precision": 0.9477611940298507,
        "recall": 0.9621212121212122,
        "f1": 0.9548872180451128
      },
      "test": {
        "accuracy": 0.9533333333333334,
        "precision": 0.9645390070921985,
        "recall": 0.9855072463768116,
        "f1": 0.974910394265233
      }
    },
    {
      "layer": 14,
      "best_C": 100.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.9266666666666666,
        "precision": 0.9481481481481482,
        "recall": 0.9696969696969697,
        "f1": 0.9588014981273408
      },
      "test": {
        "accuracy": 0.9533333333333334,
        "precision": 0.9645390070921985,
        "recall": 0.9855072463768116,
        "f1": 0.974910394265233
      }
    },
    {
      "layer": 15,
      "best_C": 100.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.9133333333333333,
        "precision": 0.9541984732824428,
        "recall": 0.946969696969697,
        "f1": 0.9505703422053232
      },
      "test": {
        "accuracy": 0.9733333333333334,
        "precision": 0.9785714285714285,
        "recall": 0.9927536231884058,
        "f1": 0.9856115107913669
      }
    },
    {
      "layer": 16,
      "best_C": 10.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.9133333333333333,
        "precision": 0.9541984732824428,
        "recall": 0.946969696969697,
        "f1": 0.9505703422053232
      },
      "test": {
        "accuracy": 0.9666666666666667,
        "precision": 0.9716312056737588,
        "recall": 0.9927536231884058,
        "f1": 0.982078853046595
      }
    },
    {
      "layer": 17,
      "best_C": 10.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.9266666666666666,
        "precision": 0.9548872180451128,
        "recall": 0.9621212121212122,
        "f1": 0.9584905660377359
      },
      "test": {
        "accuracy": 0.98,
        "precision": 0.9856115107913669,
        "recall": 0.9927536231884058,
        "f1": 0.9891696750902527
      }
    },
    {
      "layer": 18,
      "best_C": 10.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.9266666666666666,
        "precision": 0.9548872180451128,
        "recall": 0.9621212121212122,
        "f1": 0.9584905660377359
      },
      "test": {
        "accuracy": 0.98,
        "precision": 0.9856115107913669,
        "recall": 0.9927536231884058,
        "f1": 0.9891696750902527
      }
    },
    {
      "layer": 19,
      "best_C": 10.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.9466666666666667,
        "precision": 0.9626865671641791,
        "recall": 0.9772727272727273,
        "f1": 0.9699248120300752
      },
      "test": {
        "accuracy": 0.9533333333333334,
        "precision": 0.9781021897810219,
        "recall": 0.9710144927536232,
        "f1": 0.9745454545454545
      }
    },
    {
      "layer": 20,
      "best_C": 1.0,
      "train": {
        "accuracy": 0.9928571428571429,
        "precision": 1.0,
        "recall": 0.9923780487804879,
        "f1": 0.9961744452945677
      },
      "val": {
        "accuracy": 0.9133333333333333,
        "precision": 0.9541984732824428,
        "recall": 0.946969696969697,
        "f1": 0.9505703422053232
      },
      "test": {
        "accuracy": 0.9466666666666667,
        "precision": 0.9779411764705882,
        "recall": 0.9637681159420289,
        "f1": 0.9708029197080292
      }
    },
    {
      "layer": 21,
      "best_C": 1.0,
      "train": {
        "accuracy": 0.9971428571428571,
        "precision": 1.0,
        "recall": 0.9969512195121951,
        "f1": 0.9984732824427481
      },
      "val": {
        "accuracy": 0.92,
        "precision": 0.9545454545454546,
        "recall": 0.9545454545454546,
        "f1": 0.9545454545454546
      },
      "test": {
        "accuracy": 0.9533333333333334,
        "precision": 0.9781021897810219,
        "recall": 0.9710144927536232,
        "f1": 0.9745454545454545
      }
    },
    {
      "layer": 22,
      "best_C": 100.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.94,
        "precision": 0.948905109489051,
        "recall": 0.9848484848484849,
        "f1": 0.966542750929368
      },
      "test": {
        "accuracy": 0.9533333333333334,
        "precision": 0.9781021897810219,
        "recall": 0.9710144927536232,
        "f1": 0.9745454545454545
      }
    },
    {
      "layer": 23,
      "best_C": 1.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.92,
        "precision": 0.9411764705882353,
        "recall": 0.9696969696969697,
        "f1": 0.9552238805970149
      },
      "test": {
        "accuracy": 0.9333333333333333,
        "precision": 0.9705882352941176,
        "recall": 0.9565217391304348,
        "f1": 0.9635036496350365
      }
    },
    {
      "layer": 24,
      "best_C": 1.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.9133333333333333,
        "precision": 0.9219858156028369,
        "recall": 0.9848484848484849,
        "f1": 0.9523809523809523
      },
      "test": {
        "accuracy": 0.9333333333333333,
        "precision": 0.9637681159420289,
        "recall": 0.9637681159420289,
        "f1": 0.9637681159420289
      }
    },
    {
      "layer": 25,
      "best_C": 10.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.9,
        "precision": 0.920863309352518,
        "recall": 0.9696969696969697,
        "f1": 0.9446494464944649
      },
      "test": {
        "accuracy": 0.92,
        "precision": 0.9565217391304348,
        "recall": 0.9565217391304348,
        "f1": 0.9565217391304348
      }
    },
    {
      "layer": 26,
      "best_C": 0.1,
      "train": {
        "accuracy": 0.9928571428571429,
        "precision": 1.0,
        "recall": 0.9923780487804879,
        "f1": 0.9961744452945677
      },
      "val": {
        "accuracy": 0.9066666666666666,
        "precision": 0.927536231884058,
        "recall": 0.9696969696969697,
        "f1": 0.9481481481481482
      },
      "test": {
        "accuracy": 0.9,
        "precision": 0.9555555555555556,
        "recall": 0.9347826086956522,
        "f1": 0.945054945054945
      }
    },
    {
      "layer": 27,
      "best_C": 0.1,
      "train": {
        "accuracy": 0.9957142857142857,
        "precision": 1.0,
        "recall": 0.9954268292682927,
        "f1": 0.9977081741787625
      },
      "val": {
        "accuracy": 0.9,
        "precision": 0.920863309352518,
        "recall": 0.9696969696969697,
        "f1": 0.9446494464944649
      },
      "test": {
        "accuracy": 0.9,
        "precision": 0.9555555555555556,
        "recall": 0.9347826086956522,
        "f1": 0.945054945054945
      }
    },
    {
      "layer": 28,
      "best_C": 0.1,
      "train": {
        "accuracy": 0.9971428571428571,
        "precision": 1.0,
        "recall": 0.9969512195121951,
        "f1": 0.9984732824427481
      },
      "val": {
        "accuracy": 0.9,
        "precision": 0.920863309352518,
        "recall": 0.9696969696969697,
        "f1": 0.9446494464944649
      },
      "test": {
        "accuracy": 0.9,
        "precision": 0.9555555555555556,
        "recall": 0.9347826086956522,
        "f1": 0.945054945054945
      }
    },
    {
      "layer": 29,
      "best_C": 10.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.9066666666666666,
        "precision": 0.9214285714285714,
        "recall": 0.9772727272727273,
        "f1": 0.9485294117647058
      },
      "test": {
        "accuracy": 0.92,
        "precision": 0.9565217391304348,
        "recall": 0.9565217391304348,
        "f1": 0.9565217391304348
      }
    },
    {
      "layer": 30,
      "best_C": 10.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.8933333333333333,
        "precision": 0.9142857142857143,
        "recall": 0.9696969696969697,
        "f1": 0.9411764705882353
      },
      "test": {
        "accuracy": 0.9266666666666666,
        "precision": 0.9568345323741008,
        "recall": 0.9637681159420289,
        "f1": 0.9602888086642599
      }
    },
    {
      "layer": 31,
      "best_C": 1.0,
      "train": {
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0
      },
      "val": {
        "accuracy": 0.8866666666666667,
        "precision": 0.9020979020979021,
        "recall": 0.9772727272727273,
        "f1": 0.9381818181818182
      },
      "test": {
        "accuracy": 0.92,
        "precision": 0.95,
        "recall": 0.9637681159420289,
        "f1": 0.9568345323741008
      }
    }
  ]
}